window["%hammerhead%"].utils.removeInjectedScript(),function eu(nu){var iu=nu.document;!function(t,g,e,o){var h="default"in t?t.default:t,y="default"in g?g.default:g;e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e,o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o;var n=h.nativeMethods,i=/^((mouse\w+)|((dbl)?click)|(contextmenu))$/,r=/^((drag\w*)|(drop))$/,s=/^key\w+$/,l=/^(before)?input$/,a=/^(blur|(focus(in|out)?))$/,u=/^pointer\w+/,c={click:1,dblclick:2,mousedown:1,mouseup:1},f="MouseEvent",d="PointerEvent",m="KeyboardEvent",p="InputEvent",v="FocusEvent",E=(S.prototype.run=function(){var t=this.options,e=t.bubbles,n=t.cancelable,i=t.detail,o=(t.view,t.buttons),e=!1!==e,n=!1!==n,i=i||c[this.eventName],o=void 0===o?1:o;Object.assign(this.options,{bubbles:e,cancelable:n,detail:i,view:nu,buttons:o});var r,s=S._getEventCtorByEventType(this.eventName,this.options.eventConstructor);s&&(r=new s(this.eventName,this.options),this.element.dispatchEvent(r))},S._getEventCtorByEventType=function(t,e){if(e&&"function"==typeof S._getEventCtorFromWindow(e)){var n=S._getEventCtorFromNativeMethods(e);if(n&&"function"==typeof n)return n}return i.test(t)||r.test(t)?S._getEventCtorFromNativeMethods(f):u.test(t)?S._getEventCtorFromNativeMethods(d):s.test(t)?S._getEventCtorFromNativeMethods(m):l.test(t)?S._getEventCtorFromNativeMethods(p):a.test(t)?S._getEventCtorFromNativeMethods(v):S._getEventCtorFromNativeMethods("CustomEvent")},S._getEventCtorFromNativeMethods=function(t){return n["Window"+t]||S._getEventCtorFromWindow(t)},S._getEventCtorFromWindow=function(t){return nu[t]},S);function S(t,e,n){this.element=t,this.eventName=e,this.options=n}function b(t){return t.top!==t}var P=h.Promise,x=h.eventSandbox.message,_="automation|scroll|request",C="automation|scroll|response";x.on(x.SERVICE_MSG_RECEIVED_EVENT,function(t){var e,n,i,o,r,s;t.message.cmd===_&&(n=(e=t.message).offsetX,i=e.offsetY,o=e.maxScrollMargin,r=g.domUtils.findIframeByWindow(t.source),(s=new A(r,{offsetX:n,offsetY:i})).maxScrollMargin=o,s.run().then(function(){return x.sendServiceMsg({cmd:C},t.source)}))});var A=(w.prototype._isScrollValuesChanged=function(t,e){return g.styleUtils.getScrollLeft(t)!==e.left||g.styleUtils.getScrollTop(t)!==e.top},w.prototype._setScroll=function(t,e){var n=this,i=e.left,o=e.top,r=g.domUtils.isHtmlElement(t)?g.domUtils.findDocument(t):t,s={left:g.styleUtils.getScrollLeft(r),top:g.styleUtils.getScrollTop(r)},i=Math.max(i,0),o=Math.max(o,0),l=g.scrollController.waitForScroll(r);return g.styleUtils.setScrollLeft(r,i),g.styleUtils.setScrollTop(r,o),this._isScrollValuesChanged(r,s)?l=l.then(function(){n.scrollWasPerformed=n.scrollWasPerformed||n._isScrollValuesChanged(r,s)}):(l.cancel(),P.resolve())},w.prototype._getScrollToPoint=function(t,e,n){var i=e.x,o=e.y,r=Math.floor(t.width/2),s=Math.floor(Math.floor(t.height/2)),l=this.scrollToCenter?r:Math.min(n.left,r),a=this.scrollToCenter?s:Math.min(n.top,s),u=i>=t.scroll.left+t.width-l,c=i<=t.scroll.left+l,h=o>=t.scroll.top+t.height-a,f=o<=t.scroll.top+a,d=t.scroll.left,m=t.scroll.top;return u?d=i-t.width+l:c&&(d=i-l),h?m=o-t.height+a:f&&(m=o-a),{left:d,top:m}},w.prototype._getScrollToFullChildView=function(t,e,n){var i,o,r,s,l=null,a=null,u=t.width>=e.width,c=t.height>=e.height,h=g.positionUtils.calcRelativePosition(e,t);return u&&(i=t.width-e.width,o=Math.min(n.left,i),this.scrollToCenter&&(o=i/2),h.left<o?l=Math.round(t.scroll.left+h.left-o):h.right<o&&(l=Math.round(t.scroll.left+Math.min(h.left,-h.right)+o))),c&&(r=t.height-e.height,s=Math.min(n.top,r),this.scrollToCenter&&(s=r/2),h.top<s?a=Math.round(t.scroll.top+h.top-s):h.bottom<s&&(a=Math.round(t.scroll.top+Math.min(h.top,-h.bottom)+s))),{left:l,top:a}},w._getChildPoint=function(t,e,n){return{x:e.left-t.left+t.scroll.left+e.border.left+n.x,y:e.top-t.top+t.scroll.top+e.border.top+n.y}},w.prototype._getScrollPosition=function(t,e,n,i){var o=w._getChildPoint(t,e,n),r=this._getScrollToPoint(t,o,i),s=this._getScrollToFullChildView(t,e,i);return{left:Math.max(null===s.left?r.left:s.left,0),top:Math.max(null===s.top?r.top:s.top,0)}},w._getChildPointAfterScroll=function(t,e,n,i){return{x:Math.round(e.left+t.scroll.left-n.left+i.x),y:Math.round(e.top+t.scroll.top-n.top+i.y)}},w.prototype._isChildFullyVisible=function(t,e,n){var i=w._getChildPointAfterScroll(t,e,t.scroll,n),o=i.x,r=i.y,s=this._getScrollPosition(t,e,n,{left:0,top:0}),l=s.left,a=s.top;return!this._isTargetElementObscuredInPoint(o,r)&&l===t.scroll.left&&a===t.scroll.top},w.prototype._scrollToChild=function(t,e,n){for(var i=g.positionUtils.getClientDimensions(t),o=g.positionUtils.getClientDimensions(e),r=g.styleUtils.getInnerWidth(nu),s=g.styleUtils.getInnerHeight(nu),l=i.scroll,a=!this._isChildFullyVisible(i,o,n);a;){l=this._getScrollPosition(i,o,n,this.maxScrollMargin);var u=w._getChildPointAfterScroll(i,o,l,n),c=u.x,h=u.y,f=this._isTargetElementObscuredInPoint(c,h);this.maxScrollMargin.left+=20,this.maxScrollMargin.left>=r&&(this.maxScrollMargin.left=50,this.maxScrollMargin.top+=20),a=f&&this.maxScrollMargin.top<s}return this.maxScrollMargin={left:50,top:50},this._setScroll(t,l)},w.prototype._scrollElement=function(){if(!g.styleUtils.hasScroll(this.element))return P.resolve();var t=g.positionUtils.getClientDimensions(this.element),e=this._getScrollToPoint(t,{x:this.offsetX,y:this.offsetY},this.maxScrollMargin);return this._setScroll(this.element,e)},w.prototype._scrollParents=function(){var e,n,i=this,o=g.scrollUtils.getScrollableParents(this.element),r=this.element,s=this.offsetX-Math.round(g.styleUtils.getScrollLeft(r)),l=this.offsetY-Math.round(g.styleUtils.getScrollTop(r));return g.promiseUtils.times(o.length,function(t){return i._scrollToChild(o[t],r,{x:s,y:l}).then(function(){e=g.positionUtils.getClientDimensions(r),n=g.positionUtils.getClientDimensions(o[t]),s+=e.left-n.left+n.border.left,l+=e.top-n.top+n.border.top,r=o[t]})}).then(function(){return b(nu)&&!i.skipParentFrames?g.sendRequestToFrame({cmd:_,offsetX:s,offsetY:l,maxScrollMargin:i.maxScrollMargin},C,nu.parent):P.resolve()})},w._getFixedAncestorOrSelf=function(t){return g.domUtils.findParent(t,!0,g.styleUtils.isFixedElement)},w.prototype._isTargetElementObscuredInPoint=function(t,e){var n=g.positionUtils.getElementFromPoint(t,e);if(!n)return!1;var i=w._getFixedAncestorOrSelf(n);return i&&!i.contains(this.element)},w.prototype.run=function(){var t=this;return this._scrollElement().then(function(){return t._scrollParents()}).then(function(){return t.scrollWasPerformed})},w);function w(t,e){this.element=t,this.offsetX=e.offsetX,this.offsetY=e.offsetY,this.scrollToCenter=e.scrollToCenter,this.skipParentFrames=e.skipParentFrames,this.raiseEvents=e.raiseEvents,this.maxScrollMargin={left:50,top:50},this.scrollWasPerformed=!1}var T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function M(t,e){function n(){this.constructor=t}T(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function U(t,s,l,a){return new(l=l||e)(function(n,e){function i(t){try{r(a.next(t))}catch(t){e(t)}}function o(t){try{r(a.throw(t))}catch(t){e(t)}}function r(t){var e;t.done?n(t.value):((e=t.value)instanceof l?e:new l(function(t){t(e)})).then(i,o)}r((a=a.apply(t,s||[])).next())})}function D(n,i){var o,r,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,r&&(s=2&e[0]?r.return:e[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,e[1])).done)return s;switch(r=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return l.label++,{value:e[1],done:!1};case 5:l.label++,r=e[1],e=[0];continue;case 7:e=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){l=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){l.label=e[1];break}if(6===e[0]&&l.label<s[1]){l.label=s[1],s=e;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(e);break}s[2]&&l.ops.pop(),l.trys.pop();continue}e=i.call(n,l)}catch(t){e=[6,t],r=0}finally{o=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}var I=h.utils.browser;function k(t,e,n){var i=I.isFirefox?Math.ceil:Math.round,o=g.positionUtils.getOffsetPosition(t,i);return{x:(t===iu.documentElement?0:o.left)+e,y:(t===iu.documentElement?0:o.top)+n}}function B(t){if(!t)return null;var e=nu.screenLeft||nu.screenX,n=nu.screenTop||nu.screenY;return{x:e+t.x,y:n+t.y}}function N(t){var e=t/2;return e<1?0:Math.round(e)}function O(t){var e=g.positionUtils.getElementRectangle(t);return{offsetX:N(e.width),offsetY:N(e.height)}}function F(t,e,n){var i=O(t);if(e="number"==typeof e?Math.round(e):i.offsetX,n="number"==typeof n?Math.round(n):i.offsetY,0<e&&0<n)return{offsetX:e,offsetY:n};var o=g.positionUtils.getClientDimensions(t),r=Math.round(Math.max(t.scrollWidth,o.width)),s=Math.round(Math.max(t.scrollHeight,o.height)),l=o.scrollbar.right+o.border.left+o.border.right+r,a=o.scrollbar.bottom+o.border.top+o.border.bottom+s;return{offsetX:e<0?l+e:e,offsetY:n<0?a+n:n}}var Y=y.domUtils,L=b(nu)?o.iframeCursorUI:o.cursorUI,K={x:-1,y:-1,currentActiveWindow:nu.top,_ensureActiveWindow:function(){var t;this.currentActiveWindow!==nu&&this.currentActiveWindow!==nu.parent&&((t=Y.findIframeByWindow(this.currentActiveWindow))&&Y.isElementInDocument(t)||(this.currentActiveWindow=nu))},get active(){return this._ensureActiveWindow(),this.currentActiveWindow===nu},set activeWindow(t){this.currentActiveWindow=t},get activeWindow(){return this._ensureActiveWindow(),this.currentActiveWindow},get position(){return{x:this.x,y:this.y}},get visible(){return!b(nu)&&L.isVisible()},move:function(t,e){return this.x=t,this.y=e,L.move(this.x,this.y)},hide:function(){this.visible&&L.hide()},show:function(){b(nu)||L.show()},leftButtonDown:function(){return L.leftButtonDown()},rightButtonDown:function(){return L.rightButtonDown()},buttonUp:function(){return L.buttonUp()}},X=h.utils.browser,V=h.Promise,R=h.nativeMethods,W=y.positionUtils,H=y.domUtils;function G(t,e,n){var i=null;return o.hide(n).then(function(){return i=W.getElementFromPoint(t,e),o.show(n)}).then(function(){return i})}function z(t,e,n){var i=W.getElementFromPoint(t,e),o=H.containsElement(n,i)&&R.nodeTextContentGetter.call(i).length;return i&&i===n||o?i:null}function q(t,e){if(!e||!H.isDomElement(e)||!t||t===e)return t;if("tref"===H.getTagName(e))return e;var n,i,o,r="area"===H.getTagName(e)&&H.isImgElement(t);if(X.isFirefox&&r)return n=t,i=e,(o=H.closest(i,"map"))&&o.name===n.useMap.substring(1)?i:n;var s=H.isAnchorElement(e)||H.getParents(e,"a").length,l=s&&H.containsElement(e,t)&&R.nodeTextContentGetter.call(t).length;if(!s||l||!R.nodeTextContentGetter.call(e).length)return t;var a=e.getBoundingClientRect();return z(a.right-1,a.top+1,e)||z(a.left+1,a.bottom-1,e)||t}function j(n,i,o){var r=null;return G(n,i).then(function(t){r=t;var e=V.resolve(t);return!r&&b(nu)&&0<n&&0<i&&(e=e.then(function(){return G(n,i,!0)}).then(function(t){return r=t})),e.then(function(t){return q(t,o)}).then(function(t){return{element:t,corrected:t!==r}})})}function $(){var t=K.position;return j(t.x,t.y).then(function(t){return t.element})}var Z={elementIsInvisibleError:"elementIsInvisibleError",foundElementIsNotTarget:"foundElementIsNotTarget"},J=(Object.defineProperty(Q.prototype,"mouseActionStepDelay",{get:function(){return 1===this.speedFactor?10:400*(1-this.speedFactor)},enumerable:!1,configurable:!0}),Object.defineProperty(Q.prototype,"keyActionStepDelay",{get:function(){return 1===this.speedFactor?10:200*(1-this.speedFactor)},enumerable:!1,configurable:!0}),Object.defineProperty(Q.prototype,"cursorSpeed",{get:function(){return Math.pow(400,this.speedFactor)/4},enumerable:!1,configurable:!0}),Object.defineProperty(Q.prototype,"draggingSpeed",{get:function(){return Math.pow(16,this.speedFactor)/4},enumerable:!1,configurable:!0}),Q);function Q(t){this.speedFactor=t||1}var tt=(et.prototype._getAssignableProperties=function(){throw new Error("Not implemented")},et.prototype._assignFrom=function(t,e,n){if(void 0===n&&(n={}),t)for(var i=this._getAssignableProperties(),o=0;o<i.length;o++){for(var r,s=i[o],l=s.name,a=s.type,u=s.required,c=s.init,h=s.defaultValue,f=l.split("."),d=f.length-1,m=f[d],p=t,v=this,g=0;g<d&&p&&v;g++)p=p[f[g]],v=v[f[g]];v&&"defaultValue"in i[o]&&(v[l]=h),p&&v&&(void 0===(r=p[m])&&!u||(e&&a&&a(l,r),v[m]=c?c(l,r,n,e):r))}},et);function et(){}function nt(i){return function(t,e){var n=typeof e;if("number"!=n)throw new i(t,n);if(isNaN(e)||!isFinite(e)||e!==Math.floor(e))throw new i(t,e)}}function it(t,e){this.code=t,this.isTestCafeError=!0,this.callsite=e||null}var ot,rt,st,lt="E1",at="E4",ut="E5",ct="E9",ht="E10",ft="E11",dt="E12",mt="E24",pt="E26",vt="E27",gt="E28",Et="E29",yt="E30",St="E31",bt="E32",Pt="E33",xt="E34",_t="E35",Ct="E36",At="E37",wt="E39",Tt="E40",Mt="E41",Ut="E42",Dt="E43",It="E44",kt="E45",Bt="E46",Nt="E49",Ot="E50",Ft="E51",Yt="E52",Lt="E57",Kt="E64",Xt="E65",Vt="E68",Rt="E69",Wt="E70",Ht="E71",Gt="E72",zt="E73",qt="E74",jt="E76",$t="E77",Zt="E78",Jt="E82",Qt="E83",te=(M(ee,ot=it),ee);function ee(t,e,n){var i=ot.call(this,t)||this;return i.optionName=e,i.actualValue=n,i}function ne(t,e){var n=rt.call(this,Nt,e)||this;return n.instantiationCallsiteName=t,n}function ie(t,e){var n=st.call(this,Ot,e)||this;return n.instantiationCallsiteName=t,n}M(ne,rt=it),M(ie,st=it);var oe,re,se,le,ae,ue,ce,he,fe=(M(de,oe=it),de);function de(t,e,n){var i=e.apiFnChain,o=e.apiFnIndex,r=oe.call(this,t,n)||this;return r.apiFnChain=i,r.apiFnIndex=o,r}function me(t){return re.call(this,Ft,t)||this}function pe(t,e){return se.call(this,Yt,e,t)||this}function ve(t,e){var n=le.call(this,lt)||this;return n.errStack=t,n.pageDestUrl=e,n}function ge(t,e,n){var i=ae.call(this,at,n)||this;return i.errMsg=String(e),i.instantiationCallsiteName=t,i}function Ee(t,e,n,i){var o=ue.call(this,ut,i)||this;return o.errMsg=String(e),o.property=n,o.instantiationCallsiteName=t,o}function ye(t){var e=ce.call(this,Kt)||this;return e.errMsg=String(t),e}function Se(t,e){var n=he.call(this,Xt)||this;return n.errMsg=String(t),n.moduleName=e,n}M(me,re=it),M(pe,se=fe),M(ve,le=it),M(ge,ae=it),M(Ee,ue=it),M(ye,ce=it),M(Se,he=it);var be,Pe=(M(xe,be=te),xe);function xe(t,e){return be.call(this,ct,t,e)||this}var _e,Ce=(M(Ae,_e=te),Ae);function Ae(t,e){return _e.call(this,ht,t,e)||this}var we,Te=(M(Me,we=te),Me);function Me(t,e){return we.call(this,ft,t,e)||this}var Ue,De,Ie,ke,Be,Ne,Oe,Fe,Ye,Le,Ke,Xe,Ve,Re,We,He,Ge,ze,qe,je,$e,Ze,Je,Qe,tn,en,nn,on,rn,sn,ln,an,un,cn,hn,fn=(M(dn,Ue=te),dn);function dn(t,e){return Ue.call(this,dt,t,e)||this}function mn(t,e){return De.call(this,mt,e,t)||this}function pn(t){return Ie.call(this,pt,t)||this}function vn(t){var e=ke.call(this,vt)||this;return e.nodeDescription=t,e}function gn(t,e){var n=Be.call(this,gt,e)||this;return n.argumentName=t,n}function En(t){var e=Ne.call(this,Et)||this;return e.argumentName=t,e}function yn(t,e){var n=Oe.call(this,yt)||this;return n.argumentName=t,n.nodeDescription=e,n}function Sn(){return Fe.call(this,St)||this}function bn(){return Ye.call(this,bt)||this}function Pn(t){var e=Le.call(this,Pt)||this;return e.argumentName=t,e}function xn(){return Ke.call(this,_t)||this}function _n(t){var e=Xe.call(this,Ct)||this;return e.argumentName=t,e}function Cn(t,e){var n=Ve.call(this,At)||this;return n.filePaths=t,n.scannedFilePaths=e,n}function An(){return Re.call(this,xt)||this}function wn(t,e){var n=We.call(this,Mt)||this;return n.properties=t?"scrollTargetY property":e?"scrollTargetX property":"scrollTargetX and scrollTargetY properties",n}function Tn(t,e){var n=He.call(this,Lt)||this;return t<=0?e<=0?(n.verb="are",n.dimensions="width and height"):(n.verb="is",n.dimensions="width"):(n.verb="is",n.dimensions="height"),n}function Mn(t){return Ge.call(this,Tt,t)||this}function Un(){return ze.call(this,wt)||this}function Dn(){return qe.call(this,Ut)||this}function In(){return je.call(this,Rt)||this}function kn(){return $e.call(this,Vt)||this}function Bn(){return Ze.call(this,Wt)||this}function Nn(){return Je.call(this,Ht)||this}function On(){return Qe.call(this,zt)||this}function Fn(){return tn.call(this,Jt)||this}function Yn(t){var e=en.call(this,Zt)||this;return e.errMsg=t,e}function Ln(){return nn.call(this,qt)||this}function Kn(){return on.call(this,jt)||this}function Xn(){return rn.call(this,$t)||this}function Vn(){return sn.call(this,Gt)||this}function Rn(){return ln.call(this,Qt)||this}function Wn(){return an.call(this,Dt)||this}function Hn(){return un.call(this,It)||this}function Gn(t,e){var n=cn.call(this,kt)||this;return n.dialogType=t,n.pageUrl=e,n}function zn(t,e,n){var i=hn.call(this,Bt)||this;return i.dialogType=t,i.errMsg=e,i.pageUrl=n,i}M(mn,De=fe),M(pn,Ie=it),M(vn,ke=it),M(gn,Be=fe),M(En,Ne=it),M(yn,Oe=it),M(Sn,Fe=it),M(bn,Ye=it),M(Pn,Le=it),M(xn,Ke=it),M(_n,Xe=it),M(Cn,Ve=it),M(An,Re=it),M(wn,We=it),M(Tn,He=it),M(Mn,Ge=it),M(Un,ze=it),M(Dn,qe=it),M(In,je=it),M(kn,$e=it),M(Bn,Ze=it),M(Nn,Je=it),M(On,Qe=it),M(Fn,tn=it),M(Yn,en=it),M(Ln,nn=it),M(Kn,on=it),M(Xn,rn=it),M(Vn,sn=it),M(Rn,ln=it),M(Wn,an=it),M(Hn,un=it),M(Gn,cn=it),M(zn,hn=it);var qn,jn,$n,Zn,Jn,Qn=nt(Pe),ti=(jn=nt(qn=Ce),function(t,e){if(jn(t,e),e<0)throw new qn(t,e)}),ei=($n=Te,function(t,e){var n=typeof e;if("boolean"!=n)throw new $n(t,n)}),ni=(Zn=fn,function(t,e){var n=typeof e;if("number"!=n)throw new Zn(t,n);if(isNaN(e)||e<.01||1<e)throw new Zn(t,e)}),ii=(M(oi,Jn=tt),oi.prototype._getAssignableProperties=function(){return[{name:"speed",type:ni}]},oi);function oi(t,e){var n=Jn.call(this)||this;return n.speed=null,n._assignFrom(t,e),n}var ri,si=(M(li,ri=ii),li.prototype._getAssignableProperties=function(){return ri.prototype._getAssignableProperties.call(this).concat([{name:"offsetX",type:Qn},{name:"offsetY",type:Qn}])},li);function li(t,e){var n=ri.call(this)||this;return n.offsetX=null,n.offsetY=null,n._assignFrom(t,e),n}var ai,ui,ci=(M(hi,ai=si),hi.prototype._getAssignableProperties=function(){return ai.prototype._getAssignableProperties.call(this).concat([{name:"scrollToCenter",type:ei},{name:"skipParentFrames",type:ei}])},hi);function hi(t,e){var n=ai.call(this)||this;return n.scrollToCenter=!1,n.skipParentFrames=!1,n._assignFrom(t,e),n}function fi(t,e){var n=ui.call(this)||this;return n.scrollTargetX=null,n.scrollTargetY=null,n.includeMargins=!1,n.includeBorders=!0,n.includePaddings=!0,n.crop={left:null,right:null,top:null,bottom:null},n._assignFrom(t,e),n}M(fi,ui=ii),fi.prototype._getAssignableProperties=function(){return ui.prototype._getAssignableProperties.call(this).concat([{name:"scrollTargetX",type:Qn},{name:"scrollTargetY",type:Qn},{name:"crop.left",type:Qn},{name:"crop.right",type:Qn},{name:"crop.top",type:Qn},{name:"crop.bottom",type:Qn},{name:"includeMargins",type:ei},{name:"includeBorders",type:ei},{name:"includePaddings",type:ei}])};var di,mi=(M(pi,di=si),pi.prototype._getAssignableProperties=function(){return di.prototype._getAssignableProperties.call(this).concat([{name:"modifiers.ctrl",type:ei},{name:"modifiers.alt",type:ei},{name:"modifiers.shift",type:ei},{name:"modifiers.meta",type:ei}])},pi);function pi(t,e){var n=di.call(this)||this;return n.modifiers={ctrl:!1,alt:!1,shift:!1,meta:!1},n._assignFrom(t,e),n}var vi,gi=(M(Ei,vi=mi),Ei.prototype._getAssignableProperties=function(){return vi.prototype._getAssignableProperties.call(this).concat([{name:"caretPos",type:ti}])},Ei);function Ei(t,e){var n=vi.call(this)||this;return n.caretPos=null,n._assignFrom(t,e),n}var yi,Si=(M(bi,yi=mi),bi.prototype._getAssignableProperties=function(){return yi.prototype._getAssignableProperties.call(this).concat([{name:"speed"},{name:"minMovingTime"},{name:"holdLeftButton"},{name:"skipScrolling",type:ei},{name:"skipDefaultDragBehavior",type:ei}])},bi);function bi(t,e){var n=yi.call(this)||this;return n.speed=null,n.minMovingTime=null,n.holdLeftButton=!1,n.skipScrolling=!1,n.skipDefaultDragBehavior=!1,n._assignFrom(t,e),n}var Pi,xi,_i,Ci,Ai,wi=(M(Ti,Pi=gi),Ti.prototype._getAssignableProperties=function(){return Pi.prototype._getAssignableProperties.call(this).concat([{name:"replace",type:ei},{name:"paste",type:ei},{name:"confidential",type:ei}])},Ti);function Ti(t,e){var n=Pi.call(this)||this;return n.replace=!1,n.paste=!1,n.confidential=void 0,n._assignFrom(t,e),n}function Mi(t,e){var n=xi.call(this,t,e)||this;return n.destinationOffsetX=null,n.destinationOffsetY=null,n._assignFrom(t,e),n}function Ui(t,e){var n=_i.call(this)||this;return n.portraitOrientation=!1,n._assignFrom(t,e),n}function Di(t,e){var n=Ci.call(this)||this;return n.timeout=void 0,n.allowUnawaitedPromise=!1,n._assignFrom(t,e),n}function Ii(t,e){var n=Ai.call(this)||this;return n.confidential=void 0,n._assignFrom(t,e),n}function ki(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Bi(t,e,n){for(var i,o=[],r=[{x1:n.left,y1:n.top,x2:n.left,y2:n.bottom,isHorizontal:!1},{x1:n.right,y1:n.top,x2:n.right,y2:n.bottom,isHorizontal:!1},{x1:n.left,y1:n.top,x2:n.right,y2:n.top,isHorizontal:!0},{x1:n.left,y1:n.bottom,x2:n.right,y2:n.bottom,isHorizontal:!0}],s=0;s<r.length;s++)(i=function(t,e,n){var i;if(n.isHorizontal)return(i=g.positionUtils.getLineXByYCoord(t,e,n.y1))&&i>=n.x1&&i<=n.x2?{x:i,y:n.y1}:null;var o=g.positionUtils.getLineYByXCoord(t,e,n.x1);return o&&o>=n.y1&&o<=n.y2?{x:n.x1,y:o}:null}(t,e,r[s]))&&o.push(i);return o.length?1===o.length||ki(t,o[0])<ki(t,o[1])?o[0]:o[1]:null}M(Mi,xi=mi),Mi.prototype._getAssignableProperties=function(){return xi.prototype._getAssignableProperties.call(this).concat([{name:"destinationOffsetX",type:Qn},{name:"destinationOffsetY",type:Qn}])},M(Ui,_i=tt),Ui.prototype._getAssignableProperties=function(){return[{name:"portraitOrientation",type:ei}]},M(Di,Ci=tt),Di.prototype._getAssignableProperties=function(){return[{name:"timeout",type:ti},{name:"allowUnawaitedPromise",type:ei}]},M(Ii,Ai=ii),Ii.prototype._getAssignableProperties=function(){return Ai.prototype._getAssignableProperties.call(this).concat([{name:"confidential",type:ei}])};var Ni=h.Promise,Oi=h.nativeMethods;function Fi(){return new Ni(function(t){return Oi.setTimeout.call(nu,t,0)})}var Yi=function(){this.enabled=!1,this.dropAllowed=!1,this.element=null,this.dataTransfer=null,this.dataStore=null},Li=h.utils.browser,Ki=(Xi.prototype.setup=function(){this.dragAndDropMode=!1,this.dropAllowed=!1},Xi.prototype.leaveElement=function(){},Xi.prototype.move=function(){},Xi.prototype.enterElement=function(){},Xi.prototype.dragAndDrop=function(){},Xi.prototype.teardown=function(){},Xi.prototype.run=function(t,e,n,i,o){var r=e&&g.domUtils.isElementInDocument(e),s=e&&g.domUtils.isElementInIframe(e)&&!g.domUtils.getIframeByElement(e);r&&!s||(e=null);var l=t!==e,a=l?g.domUtils.getCommonAncestor(t,e):null;this.setup(),l&&e&&this.leaveElement(t,e,a,n),Li.isIE&&this.move(t,n),l&&g.domUtils.isElementInDocument(t)&&this.enterElement(t,e,a,n),Li.isIE||this.move(t,n),this.dragAndDrop(i,t,e,n,o),this.teardown(t,n,e);var u=this.dragAndDropMode,c=this.dropAllowed;return this.dragAndDropMode=!1,this.dropAllowed=!1,{dragAndDropMode:u,dropAllowed:c}},Xi);function Xi(t){var e=t.moveEvent;this.dragAndDropMode=!1,this.dropAllowed=!1,this.moveEvent=e}var Vi=h.eventSandbox.eventSimulator,Ri=h.utils.extend,Wi=h.nativeMethods,Hi=(Gi.leaveElement=function(t,e,n,i){Vi.mouseout(e,Ri({relatedTarget:t},i));for(var o=e;o&&o!==n;)Vi.mouseleave(o,Ri({relatedTarget:t},i)),o=Wi.nodeParentNodeGetter.call(o)},Gi.enterElement=function(t,e,n,i){Vi.mouseover(t,Ri({relatedTarget:e},i));for(var o=t,r=[];o&&o!==n;)r.push(o),o=g.domUtils.getParentExceptShadowRoot(o);for(var s=r.length-1;-1<s;s--)Vi.mouseenter(r[s],Ri({relatedTarget:e},i))},Gi.move=function(t,e,n){Vi[t](e,n)},Gi);function Gi(){}var zi=(qi.dragAndDrop=function(t,e,n,i){return Vi.drag(t,i),e!==n&&(g.domUtils.isElementInDocument(e)&&(i.relatedTarget=n,Vi.dragenter(e,i)),n&&(i.relatedTarget=e,Vi.dragleave(n,i))),!Vi.dragover(e,i)},qi);function qi(){}var ji,$i=h.eventSandbox.eventSimulator,Zi=(M(Ji,ji=Ki),Ji.prototype.leaveElement=function(t,e,n,i){Hi.leaveElement(t,e,n,i)},Ji.prototype.enterElement=function(t,e,n,i){Hi.enterElement(t,e,n,i)},Ji.prototype.move=function(t,e){this._needEmulateMoveEvent()&&Hi.move(this.moveEvent,t,e)},Ji.prototype.teardown=function(t,e,n){this._needEmulateMoveEvent()&&g.domUtils.isElementInDocument(t)&&t!==n&&$i[this.moveEvent](t,e)},Ji.prototype._needEmulateMoveEvent=function(){return"touchmove"!==this.moveEvent||this.holdLeftButton},Ji);function Ji(t){var e=ji.call(this,t)||this;return e.holdLeftButton=t.holdLeftButton,e}var Qi,to=(M(eo,Qi=Ki),eo.prototype.setup=function(){Qi.prototype.setup.call(this),this.dragAndDropMode=!0},eo.prototype.dragAndDrop=function(t,e,n,i){this.dropAllowed=zi.dragAndDrop(t,e,n,i)},eo);function eo(){return null!==Qi&&Qi.apply(this,arguments)||this}var no,io=h.eventSandbox.eventSimulator,oo=(M(ro,no=Ki),ro.prototype.setup=function(){no.prototype.setup.call(this),this.dragAndDropMode=!0},ro.prototype.leaveElement=function(t,e,n,i){Hi.leaveElement(t,e,n,i)},ro.prototype.move=function(t,e){Hi.move(this.moveEvent,t,e)},ro.prototype.enterElement=function(t,e,n,i){Hi.enterElement(t,e,n,i)},ro.prototype.dragAndDrop=function(t,e,n,i,o){var r=io.dragstart(t,i);o.setReadOnlyMode(),r?this.dropAllowed=zi.dragAndDrop(t,e,n,i):this.dragAndDropMode=!1},ro.prototype.run=function(t,e,n,i,o){return no.prototype.run.call(this,t,null,n,i,o)},ro);function ro(){return null!==no&&no.apply(this,arguments)||this}var so=null,lo=function(){return so},ao=function(t){so=t},uo=h.Promise,co=h.nativeMethods,ho=h.utils.featureDetection,fo=h.utils.html,mo=h.utils.url,po=h.eventSandbox.eventSimulator,vo=h.eventSandbox.message,go=h.eventSandbox.DataTransfer,Eo=h.eventSandbox.DragDataStore,yo=y.positionUtils,So=y.domUtils,bo=y.styleUtils,Po=y.eventUtils,xo=y.promiseUtils,_o=y.sendRequestToFrame,Co="automation|move|request",Ao="automation|move|response";vo.on(vo.SERVICE_MSG_RECEIVED_EVENT,function(t){t.message.cmd===Co&&(t.source.parent===nu?wo.onMoveToIframeRequest(t):(h.on(h.EVENTS.beforeUnload,function(){return vo.sendServiceMsg({cmd:Ao},t.source)}),wo.onMoveOutRequest(t)))});var wo=(To.getTarget=function(t,e,n){var i=!yo.containsOffset(t,e,n),o=i?k(t,e,n):{x:e,y:n};return{element:i?iu.documentElement:t,offsetX:o.x,offsetY:o.y}},To.onMoveToIframeRequest=function(t){var e={x:t.message.endX,y:t.message.endY},n=t.source,i=So.findIframeByWindow(n),o=bo.getBordersWidth(i),r=bo.getElementPadding(i),s=yo.getIframeClientCoordinates(i),l=yo.getIframePointRelativeToParentFrame(e,n),a=K.position,u=yo.isInRectangle(a,s)?a:Bi(a,l,s),c={x:u.x-s.left,y:u.y-s.top},h=new To(i,new Si({modifiers:t.message.modifiers,offsetX:c.x+o.left+r.left,offsetY:c.y+o.top+r.top,speed:t.message.speed,skipScrolling:!0},!1)),f={cmd:Ao,x:c.x,y:c.y};K.activeWindow!==n?h.run().then(function(){K.activeWindow=n,vo.sendServiceMsg(f,n)}):vo.sendServiceMsg(f,n)},To.onMoveOutRequest=function(t){var e=t.source,n={left:t.message.left,right:t.message.right,top:t.message.top,bottom:t.message.bottom};if(!t.message.iframeUnderCursor){var i=t.message,o=i.startX,r=i.startY,s=o-n.left,l=r-n.top,a=lo();return a&&(po.mouseout(a,{clientX:s,clientY:l,relatedTarget:null}),po.mouseleave(a,{clientX:s,clientY:l,relatedTarget:null})),void vo.sendServiceMsg({cmd:Ao},e)}var u,c=K.position,h=Bi({x:n.left+c.x,y:n.top+c.y},{x:t.message.endX,y:t.message.endY},n);h?(u=new Si({modifiers:t.message.modifiers,offsetX:h.x-n.left,offsetY:h.y-n.top,speed:t.message.speed,skipScrolling:!0},!1),new To(iu.documentElement,u).run().then(function(){var t={cmd:Ao,x:h.x,y:h.y};K.activeWindow=e,vo.sendServiceMsg(t,e)})):vo.sendServiceMsg({cmd:Ao,x:n.left,y:n.top},e)},To.prototype._getTargetClientPoint=function(){var t=bo.getElementScroll(this.element);if(So.isHtmlElement(this.element))return{x:Math.floor(this.offsetX-t.left),y:Math.floor(this.offsetY-t.top)};var e=yo.getClientPosition(this.element),n=this.element.tagName&&So.isBodyElement(this.element);return{x:Math.floor(n?e.x+this.offsetX:e.x+this.offsetX-t.left),y:Math.floor(n?e.y+this.offsetY:e.y+this.offsetY-t.top)}},To.prototype._emulateEvents=function(t){var e,n,i=this.holdLeftButton?Po.BUTTONS_PARAMETER.leftButton:Po.BUTTONS_PARAMETER.noButton,o=B({x:this.x,y:this.y}),r={clientX:this.x,clientY:this.y,screenX:o.x,screenY:o.y,buttons:i,ctrl:this.modifiers.ctrl,alt:this.modifiers.alt,shift:this.modifiers.shift,meta:this.modifiers.meta,dataTransfer:this.dragAndDropState.dataTransfer},s={moveEvent:this.moveEvent,holdLeftButton:this.holdLeftButton},l=(e=this.dragAndDropState.enabled,n=this.firstMovingStepOccured,new(e?n?to:oo:Zi)(s).run(t,lo(),r,this.dragElement,this.dragAndDropState.dataStore)),a=l.dragAndDropMode,u=l.dropAllowed;this.firstMovingStepOccured=!0,this.dragAndDropState.enabled=a,this.dragAndDropState.dropAllowed=u,ao(t)},To.prototype._movingStep=function(){var t,n=this;return this.touchMode&&!this.holdLeftButton?(this.x=this.endPoint.x,this.y=this.endPoint.y):this.startTime?(t=(Math.min(co.dateNow(),this.endTime)-this.startTime)/(this.endTime-this.startTime),this.x=Math.floor(this.startPoint.x+this.distanceX*t),this.y=Math.floor(this.startPoint.y+this.distanceY*t)):(this.startTime=co.dateNow(),this.endTime=this.startTime+this.movingTime,this.x+=0<this.distanceX?1:-1,this.y+=0<this.distanceY?1:-1),K.move(this.x,this.y).then($).then(function(t){var e=n.holdLeftButton&&n.touchMode?n.dragElement:t;return e?n._emulateEvents(e):null}).then(Fi)},To.prototype._isMovingFinished=function(){return this.x===this.endPoint.x&&this.y===this.endPoint.y},To.prototype._move=function(){var t=this;return this.startPoint=K.position,this.x=this.startPoint.x,this.y=this.startPoint.y,this.distanceX=this.endPoint.x-this.startPoint.x,this.distanceY=this.endPoint.y-this.startPoint.y,this.movingTime=Math.max(Math.abs(this.distanceX),Math.abs(this.distanceY))/this.cursorSpeed,this.minMovingTime&&(this.movingTime=Math.max(this.movingTime,this.minMovingTime)),xo.whilst(function(){return!t._isMovingFinished()},function(){return t._movingStep()})},To.prototype._scroll=function(){if(this.skipScrolling)return uo.resolve();var t=new ci({offsetX:this.offsetX,offsetY:this.offsetY},!1);return new A(this.element,t).run()},To.prototype._moveToCurrentFrame=function(){if(K.active)return uo.resolve();var t,e=K.position,n=e.x,i=e.y,o=K.activeWindow,r=null,s=null,l={cmd:Co,startX:n,startY:i,endX:this.endPoint.x,endY:this.endPoint.y,modifiers:this.modifiers,speed:this.speed};return o.parent===nu&&(r=So.findIframeByWindow(o),t=yo.getIframeClientCoordinates(r),l.left=t.left,l.top=t.top,l.right=t.right,l.bottom=t.bottom),$().then(function(t){return s=t===r,o.parent===nu&&(l.iframeUnderCursor=s),_o(l,Ao,o)}).then(function(t){return K.activeWindow=nu,s||b(nu)?K.move(t.x,t.y):null})},To.prototype.run=function(){var l=this;return $().then(function(t){l.dragElement=l.holdLeftButton?t:null;var e,n,i,o,r,s=function(t){for(var e=t;e;){if(e.draggable)return e;e=co.nodeParentNodeGetter.call(e)}return null}(l.dragElement);return s&&ho.hasDataTransfer&&!l.skipDefaultDragBehavior&&(l.dragAndDropState.enabled=!0,l.dragElement=s,l.dragAndDropState.element=l.dragElement,l.dragAndDropState.dataStore=new Eo,l.dragAndDropState.dataTransfer=new go(l.dragAndDropState.dataStore),((e=So.isAnchorElement(l.dragElement))||So.isImgElement(l.dragElement))&&(n=e?"href":"src",o=(i=mo.parseProxyUrl(l.dragElement[n]))?i.destUrl:l.dragElement[n],r=fo.cleanUpHtml(co.elementOuterHTMLGetter.call(l.dragElement)),l.dragAndDropState.dataTransfer.setData("text/plain",o),l.dragAndDropState.dataTransfer.setData("text/uri-list",o),l.dragAndDropState.dataTransfer.setData("text/html",r))),l._scroll()}).then(function(){var t=l._getTargetClientPoint(),e=t.x,n=t.y,i=bo.getWidth(nu),o=bo.getHeight(nu);return 0<=e&&e<=i&&0<=n&&n<=o?(l.endPoint={x:e,y:n},l._moveToCurrentFrame().then(function(){return l._move()})):null}).then(function(){return l.dragAndDropState})},To);function To(t,e){this.touchMode=ho.isTouchDevice,this.moveEvent=this.touchMode?"touchmove":"mousemove",this.holdLeftButton=e.holdLeftButton,this.dragElement=null,this.dragAndDropState=new Yi,this.automationSettings=new J(e.speed);var n=To.getTarget(t,e.offsetX,e.offsetY);this.element=n.element,this.offsetX=n.offsetX,this.offsetY=n.offsetY,this.speed=e.speed,this.cursorSpeed=this.holdLeftButton?this.automationSettings.draggingSpeed:this.automationSettings.cursorSpeed,this.minMovingTime=e.minMovingTime||null,this.modifiers=e.modifiers||{},this.skipScrolling=e.skipScrolling,this.skipDefaultDragBehavior=e.skipDefaultDragBehavior,this.endPoint=null,this.movingTime=null,this.x=null,this.y=null,this.startTime=null,this.endTime=null,this.distanceX=null,this.distanceY=null,this.firstMovingStepOccured=!1}var Mo,Uo=h.utils.extend,Do=function(t){var e=t.element,n=void 0===e?null:e,i=t.clientPoint,o=void 0===i?null:i,r=t.screenPoint,s=void 0===r?null:r,l=t.isTarget,a=void 0!==l&&l,u=t.inMoving,c=void 0!==u&&u;this.element=n,this.clientPoint=o,this.screenPoint=s,this.isTarget=a,this.inMoving=c,this.devicePoint=B(o)},Io=(M(ko,Mo=g.serviceUtils.EventEmitter),ko.prototype._getElementForEvent=function(t){var e=t.point;return j(e.x,e.y,g.positionUtils.containsOffset(this.element,this.options.offsetX,this.options.offsetY)?this.element:null).then(function(t){return t.element})},ko.prototype._moveToElement=function(){var t=this,e=new Si(Uo({skipScrolling:!0},this.options),!1);return new wo(this.element,e).run().then(function(){return g.delay(t.automationSettings.mouseActionStepDelay)})},ko.prototype._scrollToElement=function(){var s=this,t=new ci(this.options),e=new A(this.element,t),l=!1;return e.run().then(function(t){return l=t,g.delay(s.automationSettings.mouseActionStepDelay)}).then($).then(function(t){if(!t||!g.domUtils.contains(s.element,t)||!l)return null;var e=lo(),n=g.domUtils.getCommonAncestor(t,e),i=g.positionUtils.getClientPosition(t),o=B({x:i.x,y:i.y}),r={clientX:i.x,clientY:i.y,screenX:o.x,screenY:o.y,ctrl:!1,alt:!1,shift:!1,meta:!1,buttons:g.eventUtils.BUTTONS_PARAMETER.leftButton};return Hi.leaveElement(t,e,n,r),Hi.enterElement(t,e,n,r),ao(t),l})},ko.prototype._getElementOffset=function(){var t=F(this.element),e=this.options,n=e.offsetX,i=e.offsetY;return{offsetX:n=n||0===n?n:t.offsetX,offsetY:i=i||0===i?i:t.offsetY}},ko.prototype._wrapAction=function(t){var h=this,e=this._getElementOffset(),i=e.offsetX,o=e.offsetY,f=k(this.element,i,o),d=g.positionUtils.getClientPosition(this.element);return t().then(function(){var t,e,n,l=k(h.element,i,o),a=g.positionUtils.getClientPosition(h.element),u=(t=h.element,e=l,n=g.styleUtils.getElementScroll(t),!/html/i.test(t.tagName)&&g.styleUtils.hasScroll(t)&&(e.x-=n.left,e.y-=n.top),g.positionUtils.offsetToClientCoords(e)),c=g.positionUtils.containsOffset(h.element,i,o)?h.element:null;return j(u.x,u.y,c).then(function(t){var e=t.element,n=t.corrected,i=e;if(!i)return new Do({});var o=(o=!c||n||i===h.element)||-1<g.arrayUtils.indexOf(g.domUtils.getParents(i),h.element),r=f.x!==l.x||f.y!==l.y,s=d.x!==a.x||d.y!==a.y;return new Do({element:e,clientPoint:u,screenPoint:l,isTarget:o,inMoving:r&&s})})})},ko._checkElementState=function(t,e){if(!t.element)throw new Error(Z.elementIsInvisibleError);if(e&&(!t.isTarget||t.inMoving))throw new Error(Z.foundElementIsNotTarget);return t},ko.prototype._ensureElement=function(e,n,i){var o=this;return this._wrapAction(function(){return o._scrollToElement()}).then(function(t){return ko._checkElementState(t,e)}).then(function(t){return i?t:o._wrapAction(function(){return o._moveToElement()})}).then(function(t){return n||ko._checkElementState(t,e),t}).then(function(t){return o.emit(o.TARGET_ELEMENT_FOUND_EVENT,{element:t.element}),{element:t.element,clientPoint:t.clientPoint,screenPoint:t.screenPoint,devicePoint:t.devicePoint}})},ko);function ko(t,e){var n=Mo.call(this)||this;return n.TARGET_ELEMENT_FOUND_EVENT="automation|target-element-found-event",n.element=t,n.options=e,n.automationSettings=new J(e.speed),n}var Bo,No=h.Promise,Oo=(M(Fo,Bo=Io),Fo.prototype.run=function(t){var e=this,n=No.resolve();return this.element!==iu.scrollingElement&&this.element!==iu.documentElement&&(n=this._ensureElement(t,!0,!0)),n.then(function(){e.element.scrollLeft=e.scrollLeft,e.element.scrollTop=e.scrollTop})},Fo);function Fo(t,e,n){var i,o,r,s,l,a=e.x,u=e.y,c=e.position,h=e.byX,f=e.byY,d=Bo.call(this,t,n)||this;return c&&(o=t,r=c,s=Math.floor(o.scrollWidth/2-o.clientWidth/2),l=Math.floor(o.scrollHeight/2-o.clientHeight/2),a=(i={top:[s,0],right:[o.scrollWidth,l],bottom:[s,o.scrollHeight],left:[0,l],topRight:[o.scrollWidth,0],topLeft:[0,0],bottomRight:[o.scrollWidth,o.scrollHeight],bottomLeft:[0,o.scrollHeight],center:[s,l]}[r])[0],u=i[1]),d.scrollLeft="number"==typeof a?a:t.scrollLeft,d.scrollTop="number"==typeof u?u:t.scrollTop,h&&(d.scrollLeft+=h),f&&(d.scrollTop+=f),d}var Yo,Lo=(M(Ko,Yo=Io),Ko.prototype.run=function(t){return this._ensureElement(t,!0,!0)},Ko);function Ko(t,e){return Yo.call(this,t,e)||this}var Xo=h.Promise,Vo=h.eventSandbox.message;function Ro(t,i,e){return new Xo(function(n){Vo.on(Vo.SERVICE_MSG_RECEIVED_EVENT,function t(e){e.message.cmd===i&&(Vo.off(Vo.SERVICE_MSG_RECEIVED_EVENT,t),n(e.message))}),Vo.sendServiceMsg(t,e)})}var Wo=h.Promise,Ho=h.nativeMethods,Go=h.utils.browser,zo=h.eventSandbox.focusBlur,qo=y.contentEditable,jo=y.textSelection,$o=y.domUtils,Zo=y.styleUtils,Jo=h.eventSandbox.message,Qo="automation|iframe|request",tr="automation|iframe|response";function er(v,g,E){var t=this;return new Wo(function(p){return U(t,void 0,void 0,function(){var s,n,i,o,r,l,a,u,c,h,f,d,m;return D(this,function(t){switch(t.label){case 0:return b(nu)?[4,Ro({cmd:Qo},tr,nu.parent)]:[3,2];case 1:t.sent(),t.label=2;case 2:if(s=$o.getActiveElement(),n=$o.isTextEditableElement(v),i=$o.closest(v,"label[for]"),o=$o.isElementFocusable(v),r=!o&&i,l=$o.isContentEditableElement(v),a=l?qo.findContentEditableParent(v):v,g&&Go.isWebKit&&n&&jo.select(v,0,0),r)return g&&(e=i,$o.isElementFocusable(e)?zo.focus(e,y.noop,!1,!0):ir(e)),p(),[2];if(u=!g,c=!1,!o&&!l){if(h=$o.findDocument(a),f=Ho.documentActiveElementGetter.call(h),d=$o.isBodyElement(f),m=$o.isBodyElement(a)?a:$o.getFocusableParent(a),f&&!d&&$o.containsElement(f,a)||d&&$o.isBodyElement(m))return p(),[2];a=m||h.body,c=!0}return zo.focus(a,function(){var t,e,n,i,o,r;!g||l||v===$o.getActiveElement()?(t=v,e=E,o=$o.isTextEditableElement(t),r=$o.isContentEditableElement(t),o||r?r&&isNaN(parseInt(e,10))?jo.setCursorToLastVisiblePosition(t):(n=isNaN(parseInt(e,10))?$o.getElementValue(t).length:e,jo.select(t,n,n)):(i=qo.findContentEditableParent(t))&&jo.setCursorToLastVisiblePosition(qo.findContentEditableParent(i)),g||$o.getActiveElement()===s?p():zo.focus(s,p,!0,!0)):p()},u,!0,!1,c),[2]}var e})})})}function nr(t){var e=$o.closest(t,"label[for]"),n=e&&(e.control||iu.getElementById(e.htmlFor));return n&&Zo.isElementVisible(n)?n:null}function ir(t){var e=nr(t);e&&$o.getActiveElement()!==e&&zo.focus(e,y.noop,!1,!0)}Jo.on(Jo.SERVICE_MSG_RECEIVED_EVENT,function(t){var e;t.message.cmd===Qo&&(e=$o.findIframeByWindow(t.source),zo.focus(e,function(){Jo.sendServiceMsg({cmd:tr},t.source)},!1))});var or=h.utils.browser,rr=h.eventSandbox.eventSimulator,sr=h.eventSandbox.listeners,lr=h.nativeMethods,ar=y.domUtils,ur=y.styleUtils,cr=o.selectElement,hr=(fr.prototype.run=function(){this.eventState.clickElement&&rr.click(this.eventState.clickElement,this.eventArgs.options),ar.isElementFocusable(this.eventArgs.element)||ir(this.eventArgs.element)},fr);function fr(t,e){this.eventState=t,this.eventArgs=e}var dr,mr=(M(pr,dr=hr),pr.prototype.run=function(){function t(t){n=lr.eventTargetGetter.call(t)===e.input}var e=this,n=!1;sr.addInternalEventBeforeListener(nu,["focus"],t),dr.prototype.run.call(this),sr.removeInternalEventBeforeListener(nu,["focus"],t),ar.isElementFocusable(this.label)&&!n&&this._ensureBoundElementFocusRaised()},pr.prototype._ensureBoundElementFocusRaised=function(){rr.focus(this.input)},pr);function pr(t,e){var n=dr.call(this,t,e)||this;return n.label=n.eventArgs.element,n.input=nr(n.eventArgs.element),n}var vr,gr=(M(Er,vr=hr),Er.prototype.run=function(){vr.prototype.run.call(this),this._toggleSelectOptionList()},Er.prototype._toggleSelectOptionList=function(){var t=this.eventArgs.element;1===ur.getSelectElementSize(t)&&!1!==this.eventState.simulateDefaultBehavior&&(cr.isOptionListExpanded(t)?cr.collapseOptionList():cr.expandOptionList(t))},Er);function Er(t,e){return vr.call(this,t,e)||this}var yr,Sr=(M(br,yr=hr),br.prototype.run=function(){return this.eventArgs.element},br);function br(t,e){return yr.call(this,t,e)||this}var Pr,xr=(M(_r,Pr=mr),_r.prototype.run=function(){function t(){e=!0}var e=!1;sr.addInternalEventBeforeListener(nu,["change"],t),Pr.prototype.run.call(this),sr.removeInternalEventBeforeListener(nu,["change"],t),or.isChrome&&!e&&this._ensureCheckboxStateChanged()},_r.prototype._ensureCheckboxStateChanged=function(){this.checkbox.checked=!this.checkbox.checked,rr.change(this.checkbox)},_r);function _r(t,e){var n=Pr.call(this,t,e)||this;return n.checkbox=n.input,n}var Cr,Ar=h.Promise,wr=h.utils.extend,Tr=h.utils.browser,Mr=h.utils.featureDetection,Ur=h.eventSandbox.eventSimulator,Dr=h.eventSandbox.listeners,Ir=y.domUtils,kr=y.eventUtils,Br=y.arrayUtils,Nr=y.delay,Or=(M(Fr,Cr=Io),Fr.prototype._bindMousedownHandler=function(){var e=this,n=function(t){e.eventState.mousedownPrevented=t.defaultPrevented,kr.preventDefault(t),kr.unbind(e.element,"mousedown",n)};kr.bind(this.element,"mousedown",n)},Fr.prototype._bindBlurHandler=function(t){var e=this,n=function(){e.eventState.blurRaised=!0,kr.unbind(t,"blur",n,!0)};kr.bind(t,"blur",n,!0)},Fr.prototype._isTouchEventWasCancelled=function(){return this.eventState.touchStartCancelled||this.eventState.touchEndCancelled},Fr.prototype._raiseTouchEvents=function(t){Mr.isTouchDevice&&(this.eventState.touchStartCancelled=!Ur.touchstart(t.element,t.options),this.eventState.touchEndCancelled=!Ur.touchend(t.element,t.options))},Fr.prototype._mousedown=function(n){var i=this;return this.targetElementParentNodes=Ir.getParents(n.element),this.mouseDownElement=n.element,K.leftButtonDown().then(function(){i._raiseTouchEvents(n);var t=Ir.getActiveElement();i.activeElementBeforeMouseDown=t;var e=(Tr.isWebKit||Tr.isIE)&&Ir.isSelectElement(i.mouseDownElement);return e&&i._bindMousedownHandler(),i._bindBlurHandler(t),i._isTouchEventWasCancelled()||(i.eventState.simulateDefaultBehavior=Ur.mousedown(n.element,n.options)),!1===i.eventState.simulateDefaultBehavior&&(i.eventState.simulateDefaultBehavior=e&&!i.eventState.mousedownPrevented),i._ensureActiveElementBlur(t)}).then(function(){return i._focus(n)})},Fr.prototype._ensureActiveElementBlur=function(e){var n=this;return new Ar(function(t){Ir.getActiveElement()===e||n.eventState.blurRaised?t():Tr.isIE&&Tr.version<12?Fi().then(function(){n.eventState.blurRaised||Ur.blur(e),t()}):(Ur.blur(e),t())})},Fr.prototype._focus=function(t){return!1===this.eventState.simulateDefaultBehavior?Ar.resolve():er(Ir.isContentEditableElement(this.element)?this.element:t.element,!Tr.isIE||this.activeElementBeforeMouseDown===Ir.getActiveElement(),this.caretPos)},Fr._getElementForClick=function(t,e,n){var i=Ir.getParents(e),o=Ir.isTheSameNode(e,t);return Tr.isFirefox?o?t:null:o?Br.equals(n,i)?t:null:t.contains(e)&&!Ir.isEditableFormElement(e)?t:e.contains(t)?e:Br.getCommonElement(i,n)},Fr.prototype._mouseup=function(i){var o=this;return K.buttonUp().then(function(){return o._getElementForEvent(i)}).then(function(t){i.element=t,o.eventState.clickElement=Fr._getElementForClick(o.mouseDownElement,t,o.targetElementParentNodes);var e={},n=function(t){e=t.timeStamp,Dr.removeInternalEventBeforeListener(nu,["mouseup"],n)};return Tr.isIE||Dr.addInternalEventBeforeListener(nu,["mouseup"],n),o._isTouchEventWasCancelled()||Ur.mouseup(t,i.options),{timeStamp:e}})},Fr.prototype._click=function(t){var e,n,i,o,r,s,l,a=(e=this.eventState,i=nr((n=t).element),o=ar.isSelectElement(n.element),r=ar.isOptionElement(n.element),s=ar.isLabelElement(n.element)&&i,l=i&&ar.isCheckboxElement(i),new(o?gr:r?Sr:l?xr:s?mr:hr)(e,n));return this._isTouchEventWasCancelled()||a.run(),t},Fr.prototype.run=function(t){var r=this,s=null;return this._ensureElement(t).then(function(t){var e=t.element,n=t.clientPoint,i=t.screenPoint,o=t.devicePoint;return s={point:n,screenPoint:i,element:e,options:wr({clientX:n.x,clientY:n.y,screenX:o.x,screenY:o.y},r.modifiers)},Ar.all([Nr(r.automationSettings.mouseActionStepDelay),r._mousedown(s)])}).then(function(){return r._mouseup(s)}).then(function(t){var e=t.timeStamp;return s.options.timeStamp=e,r._click(s)})},Fr);function Fr(t,e){var n=Cr.call(this,t,e)||this;return n.modifiers=e.modifiers,n.caretPos=e.caretPos,n.targetElementParentNodes=[],n.activeElementBeforeMouseDown=null,n.mouseDownElement=null,n.eventState={mousedownPrevented:!1,blurRaised:!1,simulateDefaultBehavior:!0,clickElement:null,touchStartCancelled:!1,touchEndCancelled:!1},n}var Yr=h.Promise,Lr=h.utils.browser,Kr=h.utils.featureDetection,Xr=h.eventSandbox.eventSimulator,Vr=h.eventSandbox.focusBlur,Rr=h.nativeMethods,Wr=y.domUtils,Hr=y.styleUtils,Gr=y.delay,zr=o.selectElement,qr=Kr.isTouchDevice?0:160,jr=($r.prototype._calculateEventArguments=function(){var t=this.optionListExpanded?zr.getEmulatedChildElement(this.element):this.element,e=1<Hr.getSelectElementSize(this.parentSelect);return{options:this.modifiers,element:Lr.isIE&&e?this.parentSelect:t}},$r.prototype._getMoveArguments=function(){var t,e,n=null,i=null,o=null;return o=this.optionListExpanded?(i=(t=O(n=zr.getEmulatedChildElement(this.element))).offsetX,t.offsetY):(n=iu.documentElement,i=(e=zr.getSelectChildCenter(this.element)).x,e.y),{element:n,offsetX:i,offsetY:o,speed:this.speed}},$r.prototype._move=function(t){var e=this,n=t.element,i=t.offsetX,o=t.offsetY,r=t.speed,s=new Si({offsetX:i,offsetY:o,speed:r,modifiers:this.modifiers},!1);return new wo(n,s).run().then(function(){return Gr(e.automationSettings.mouseActionStepDelay)})},$r.prototype._mousedown=function(){var t=this;return Lr.isFirefox?(Xr.mousedown(this.eventsArgs.element,this.eventsArgs.options),this.clickCausesChange&&(this.parentSelect.selectedIndex=this.childIndex),this._focus()):Lr.isIE?(Xr.mousedown(this.eventsArgs.element,this.eventsArgs.options),this._focus()):this._focus().then(function(){return Gr(qr)}).then(function(){Xr.mousedown(t.eventsArgs.element,t.eventsArgs.options),t.clickCausesChange&&(t.parentSelect.selectedIndex=t.childIndex)})},$r.prototype._focus=function(){var e=this;return new Yr(function(t){Vr.focus(e.parentSelect,t,!1,!0)})},$r.prototype._mouseup=function(){var t=Lr.isIE?this.parentSelect:this.eventsArgs.element;Xr.mouseup(t,this.eventsArgs.options),Lr.isIE&&this.clickCausesChange&&(this.parentSelect.selectedIndex=this.childIndex);var e=Lr.isFirefox||Lr.isSafari||Lr.isChrome&&53<=Lr.version,n=e||Lr.isIE;return e&&this.clickCausesChange&&Xr.input(this.parentSelect),n&&this.clickCausesChange&&Xr.change(this.parentSelect),Yr.resolve()},$r.prototype._click=function(){Xr.click(this.eventsArgs.element,this.eventsArgs.options)},$r.prototype.run=function(){var t=this;if(!this.parentSelect)return Xr.click(this.eventsArgs.element,this.eventsArgs.options),Yr.resolve();this.optionListExpanded||zr.scrollOptionListByChild(this.element);var e=this._getMoveArguments();return this.eventsArgs=this._calculateEventArguments(),Hr.getSelectElementSize(this.parentSelect)<=1?this._move(e).then(function(){return t._click()}):this._move(e).then(function(){return t._mousedown()}).then(function(){return t._mouseup()}).then(function(){return t._click()})},$r);function $r(t,e){var n,i,o,r,s;this.element=t,this.modifiers=e.modifiers,this.caretPos=e.caretPos,this.offsetX=e.offsetX,this.offsetY=e.offsetY,this.speed=e.speed,this.automationSettings=new J(e.speed),this.parentSelect=Wr.getSelectParent(this.element),this.optionListExpanded=!!this.parentSelect&&zr.isOptionListExpanded(this.parentSelect),this.childIndex=null,this.clickCausesChange=!1,this.parentSelect&&(n=Wr.isOptionElement(this.element),i=this.parentSelect.selectedIndex,this.childIndex=Wr.getElementIndexInParent(this.parentSelect,this.element),o=Rr.nodeParentNodeGetter.call(this.element),r=Wr.isOptionGroupElement(o)?o:null,s=this.element.disabled||r&&r.disabled,this.clickCausesChange=n&&!s&&this.childIndex!==i),this.eventsArgs={options:this.modifiers,element:this.element}}var Zr,Jr=h.utils.featureDetection,Qr=h.utils.browser,ts=h.eventSandbox.eventSimulator,es=y.eventUtils,ns=y.delay,is=Jr.isTouchDevice?0:160,os=(M(rs,Zr=Io),rs.prototype._firstClick=function(t){var e=this,n=new gi(this.options);n.speed=1;var i=new Or(this.element,n);return i.on(i.TARGET_ELEMENT_FOUND_EVENT,function(t){return e.emit(e.TARGET_ELEMENT_FOUND_EVENT,t)}),i.run(t).then(function(t){return ns(is).then(function(){return t})})},rs.prototype._secondClick=function(t){var e=this;Qr.isIE&&es.bind(iu,"focus",es.preventDefault,!0);var n=new gi({offsetX:t.screenPoint.x,offsetY:t.screenPoint.y,caretPos:this.caretPos,modifiers:this.modifiers,speed:1}),i=new Or(iu.documentElement,n);return i.run().then(function(t){return e.eventState.dblClickElement=i.eventState.clickElement,Qr.isIE&&es.unbind(iu,"focus",es.preventDefault,!0),t})},rs.prototype._dblClick=function(t){this.eventState.dblClickElement&&ts.dblclick(this.eventState.dblClickElement,t.options)},rs.prototype.run=function(t){var e=this;return this._firstClick(t).then(function(t){return e._secondClick(t)}).then(function(t){return e._dblClick(t)})},rs);function rs(t,e){var n=Zr.call(this,t,e)||this;return n.modifiers=e.modifiers,n.caretPos=e.caretPos,n.speed=e.speed,n.automationSettings=new J(n.speed),n.offsetX=e.offsetX,n.offsetY=e.offsetY,n.eventArgs=null,n.eventState={dblClickElement:null},n}var ss,ls=h.Promise,as=h.utils.extend,us=h.utils.featureDetection,cs=h.eventSandbox.eventSimulator,hs=h.eventSandbox.focusBlur,fs=(M(ds,ss=Io),ds.prototype._getEndPoint=function(){throw new Error("Not implemented")},ds.prototype._mousedown=function(t){var e=this;return K.leftButtonDown().then(function(){return e.simulateDefaultBehavior=cs[e.downEvent](t.element,t.options),e._focus(t)})},ds.prototype._focus=function(n){var i=this;return new ls(function(t){var e=g.domUtils.isContentEditableElement(i.element)?g.contentEditable.findContentEditableParent(i.element):n.element;hs.focus(e,t,!1,!0)})},ds.prototype._getDestination=function(){throw new Error("Not implemented")},ds.prototype._drag=function(){var e=this,t=this._getDestination(),n=t.element,i=t.offsets,o=t.endPoint;this.endPoint=o;var r=new Si({offsetX:i.offsetX,offsetY:i.offsetY,modifiers:this.modifiers,speed:this.speed,minMovingTime:25,holdLeftButton:!0,skipDefaultDragBehavior:!1===this.simulateDefaultBehavior},!1);return new wo(n,r).run().then(function(t){return e.dragAndDropState=t,g.delay(e.automationSettings.mouseActionStepDelay)})},ds.prototype._mouseup=function(){var r=this;return K.buttonUp().then(function(){var n=g.positionUtils.offsetToClientCoords(r.endPoint),i=null,o=as({clientX:n.x,clientY:n.y},r.modifiers);return j(n.x,n.y).then(function(t){var e=t.element;return(i=e)?(r.dragAndDropState.enabled?(o.dataTransfer=r.dragAndDropState.dataTransfer,r.dragAndDropState.dropAllowed&&cs.drop(i,o),cs.dragend(r.dragAndDropState.element,o),r.dragAndDropState.dataStore.setProtectedMode()):cs[r.upEvent](i,o),j(n.x,n.y)):i}).then(function(t){var e=t.element;i&&e===i&&!r.dragAndDropState.enabled&&cs.click(i,o)})})},ds.prototype.run=function(t){var i,o=this;return this._ensureElement(t).then(function(t){var e=t.element,n=t.clientPoint;return i={point:n,element:e,options:as({clientX:n.x,clientY:n.y},o.modifiers)},ls.all([g.delay(o.automationSettings.mouseActionStepDelay),o._mousedown(i)])}).then(function(){return o._drag()}).then(function(){return o._mouseup()})},ds);function ds(t,e){var n=ss.call(this,t,e)||this;return n.modifiers=e.modifiers,n.speed=e.speed,n.offsetX=e.offsetX,n.offsetY=e.offsetY,n.endPoint=null,n.simulateDefaultBehavior=!0,n.downEvent=us.isTouchDevice?"touchstart":"mousedown",n.upEvent=us.isTouchDevice?"touchend":"mouseup",n.dragAndDropState=null,n}var ms,ps=y.styleUtils,vs=(M(gs,ms=fs),gs.prototype._getDestination=function(){var t=k(this.element,this.offsetX,this.offsetY),e=ps.getWidth(iu),n=ps.getHeight(iu),i={x:t.x+this.dragOffsetX,y:t.y+this.dragOffsetY},i={x:Math.min(Math.max(0,i.x),e),y:Math.min(Math.max(0,i.y),n)};return{element:iu.documentElement,offsets:{offsetX:i.x,offsetY:i.y},endPoint:i}},gs);function gs(t,e,n,i){var o=ms.call(this,t,i)||this;return o.dragOffsetX=e,o.dragOffsetY=n,o}var Es,ys=y.positionUtils,Ss=(M(bs,Es=fs),bs.prototype._getDestination=function(){var t=this.destinationElement,e=ys.getElementRectangle(t),n=F(t,this.destinationOffsetX,this.destinationOffsetY);return{element:t,offsets:n,endPoint:{x:e.left+n.offsetX,y:e.top+n.offsetY}}},bs);function bs(t,e,n){var i=Es.call(this,t,n)||this;return i.destinationElement=e,i.destinationOffsetX=n.destinationOffsetX,i.destinationOffsetY=n.destinationOffsetY,i}var Ps,xs=(M(_s,Ps=Io),_s.prototype.run=function(t){return this._ensureElement(t,!0)},_s);function _s(t,e){return Ps.call(this,t,e)||this}var Cs=h.utils.browser,As=h.sandbox.event,ws=h.eventSandbox.eventSimulator,Ts=h.eventSandbox.listeners,Ms=h.nativeMethods,Us=y.domUtils,Ds=y.contentEditable,Is=y.textSelection,ks=/ /g;function Bs(t){var e=Is.getSelectionByElement(t),n=Is.hasInverseSelectionContentEditable(t);return Is.hasElementContainsSelection(t)?Ds.getSelection(t,e,n):{startPos:Ds.calculateNodeAndOffsetByPosition(t,0),endPos:Ds.calculateNodeAndOffsetByPosition(t,0)}}function Ns(t){var e=t.startPos.node,n=t.startPos.offset,i=t.endPos.offset,o=Ds.getFirstNonWhitespaceSymbolIndex(e.nodeValue),r=Ds.getLastNonWhitespaceSymbolIndex(e.nodeValue);return n<o&&0!==n?(t.startPos.offset=o,t.endPos.offset=i+o-n):r<i&&i!==e.nodeValue.length&&(t.startPos.offset=e.nodeValue.length,t.endPos.offset=i+e.nodeValue.length-n),t}function Os(t,e,n){return!n||ws.beforeInput(t,e)}function Fs(t,e){var n;function i(t){t.preventDefault(),n=!0}function o(t){"textInput"===t.type&&(n=!1)}Cs.isSafari&&(Ts.addInternalEventBeforeListener(nu,["textInput"],i),As.on(As.EVENT_PREVENTED_EVENT,o));var r=Cs.isFirefox||ws.textInput(t,e)||n;return Cs.isSafari&&(Ts.removeInternalEventBeforeListener(nu,["textInput"],i),As.off(As.EVENT_PREVENTED_EVENT,o)),r||Cs.isIE11}function Ys(t,e){var n,i,o,r,s,l,a,u,c,h,f,d=Bs(t),m=d.startPos.node,p=d.endPos.node,v=!0,g=!0,E=e;function y(){g=!1}function S(t,e,n){n()}e=e.replace(ks,String.fromCharCode(160)),m&&p&&Us.isContentEditableElement(m)&&Us.isContentEditableElement(p)&&(Us.isTheSameNode(m,p)||(Is.deleteSelectionContents(t),n=t,o=(i=d).startPos.node,r=Ms.nodeParentNodeGetter.call(o)&&o.parentElement,!(Cs.isChrome&&Cs.version<58||Cs.isSafari)&&r&&Us.isElementContainsNode(n,o)||(i=Bs(n),Is.hasInverseSelectionContentEditable(n)&&(i={startPos:i.endPos,endPos:i.startPos})),i.endPos.offset=i.startPos.offset,m=(d=i).startPos.node),m&&Us.isContentEditableElement(m)&&Us.isRenderedNode(m)&&Os(t,e,Cs.isChrome||Cs.isFirefox)&&(v=Fs(t,E),g=v&&!Cs.isIE11,Ts.addInternalEventBeforeListener(nu,["input"],y),Ts.addInternalEventBeforeListener(nu,["textinput"],S),(v=v&&Os(t,e,Cs.isSafari))&&(Us.isElementNode(m)?(s=m,l=e,c=iu.createTextNode(l),h={node:c,offset:l.length},f=Ms.nodeParentNodeGetter.call(s),"br"===Us.getTagName(s)?f.insertBefore(c,s):0<a?(u=Ms.nodeChildNodesGetter.call(s),s.insertBefore(c,u[a])):s.appendChild(c),Is.selectByNodesAndOffsets(h,h)):function(t,e,n){var i=e.startPos.node;Us.isElementContainsNode(t,i)||(i=(e=Ns(Bs(t))).startPos.node);var o=e.startPos.offset,r=e.endPos.offset,s=i.nodeValue,l={node:i,offset:o+n.length};i.nodeValue=s.substring(0,o)+n+s.substring(r,s.length),Is.selectByNodesAndOffsets(l,l)}(t,Ns(d),e)),Fi().then(function(){g&&ws.input(t,e),Ts.removeInternalEventBeforeListener(nu,["input"],y),Ts.removeInternalEventBeforeListener(nu,["textinput"],S)})))}function Ls(t,e,n){var i,o,r,s,l,a,u,c,h,f,d,m,p;Us.isContentEditableElement(t)&&Ys(t,e),Us.isElementReadOnly(t)||(Us.isTextEditableElement(t)?(l=t,a=e,h=Us.getElementValue(l),f=a.length,d=Is.getSelectionStart(l),m=Is.getSelectionEnd(l),p=Us.isInputElement(l)&&"number"===l.type,Os(l,a,Cs.isChrome||Cs.isFirefox)&&Fs(l,a)&&Os(l,a,Cs.isSafari)&&((u=!Cs.isIE&&p?null:parseInt(l.maxLength,10))<0&&(u=Cs.isIE&&Cs.version<17?0:null),c=h.substring(0,d)+a+h.substring(m,h.length),(null===u||isNaN(u)||c.length<=u)&&(p&&Cs.isIOS&&"."===h[h.length-1]&&(d+=1),Us.setElementValue(l,c),Is.select(l,d+f,d+f)),ws.input(l,a))):Us.isInputElement(t)&&(i=t,o=e,null!==(r=n)?(s=Us.getElementValue(i),Us.setElementValue(i,s.substr(0,r)+o+s.substr(r+o.length))):Us.setElementValue(i,o),ws.change(i),ws.input(i,o)))}function Ks(t){return 1===t.length&&("a"<=t&&t<="z"||"A"<=t&&t<="Z")}var Xs=h.nativeMethods,Vs=h.utils.browser,Rs=h.eventSandbox.focusBlur,Ws=h.Promise,Hs=g.domUtils.isRadioButtonElement,Gs=g.domUtils.getActiveElement,zs=g.domUtils.getTabIndexAttributeIntValue;function qs(t){return t===t.toLowerCase()?t.toUpperCase():t.toLowerCase()}function js(t){var e=Gs(t||iu),n=null;if(e&&g.domUtils.isIframeElement(e)&&Xs.contentDocumentGetter.call(e))try{n=js(Xs.contentDocumentGetter.call(e))}catch(t){}return n||e}function $s(t,e,n){if(!Hs(e))return t;if(!n&&!e.name&&!Vs.isChrome)return[e];var i,o,r=(i=e,o=null,n?""===i.name||Vs.isFirefox||(o=function(t){return!t.name||t===i||t.name!==i.name}):""!==i.name?o=function(t){return Hs(t)&&t.name===i.name}:Vs.isChrome&&(o=function(t){return Hs(t)&&!t.name}),o);return r&&(t=g.arrayUtils.filter(t,r)),t}function Zs(t,e,n){var i,o,r,s,l,a,u,c,h=e?-1:1,f=g.domUtils.getTopSameDomainWindow(nu).document,d=(i=f,o=Xs.documentActiveElementGetter.call(i),r=o&&zs(o),!(o&&r<0)),m=$s(m=g.domUtils.getFocusableElements(f,d),t,n),p=Hs(t),v=g.arrayUtils.indexOf(m,t);return(e?0===v:v===m.length-1)?!e&&t.tabIndex<0?g.arrayUtils.find(m,function(t){return 0===t.tabIndex}):n||!p?iu.body:m[m.length-1-v]:e&&-1===v?m[m.length-1]:(l=(s=m)[v+h],a=n,u=Hs(l)&&l.name&&!l.checked,c=null,a&&u&&(c=g.arrayUtils.find(s,function(t){return Hs(t)&&t.name===l.name&&t.checked})),c||l)}function Js(t){if(Ks(t))return t.toUpperCase().charCodeAt(0);var e=g.KEY_MAPS.shiftMap[t]?g.KEY_MAPS.shiftMap[t].charCodeAt(0):t.charCodeAt(0);return g.KEY_MAPS.symbolCharCodeToKeyCode[e]||e}var Qs={SPECIAL_KEYS:{capslock:"CapsLock",delete:"U+007F",end:"End",enter:"Enter",esc:"U+001B",home:"Home",ins:"Insert",pagedown:"PageDown",pageup:"PageUp",space:"U+0020",tab:"Tab",alt:"Alt",ctrl:"Control",meta:"Meta",shift:"Shift"},LETTERS:{a:"U+0041",b:"U+0042",c:"U+0043",d:"U+0044",e:"U+0045",f:"U+0046",g:"U+0047",h:"U+0048",i:"U+0049",j:"U+004A",k:"U+004B",l:"U+004C",m:"U+004D",n:"U+004E",o:"U+004F",p:"U+0050",q:"U+0051",r:"U+0052",s:"U+0053",t:"U+0054",u:"U+0055",v:"U+0056",w:"U+0057",x:"U+0058",y:"U+0059",z:"U+005A"},SYMBOLS:{0:"U+0030",1:"U+0031",2:"U+0032",3:"U+0033",4:"U+0034",5:"U+0035",6:"U+0036",7:"U+0037",8:"U+0038",9:"U+0039"," ":"U+0020","!":"U+0021","@":"U+0040","#":"U+0023",$:"U+0024","%":"U+0025","^":"U+005E","*":"U+002A","(":"U+0028",")":"U+0029",_:"U+005F","|":"U+007C","\\":"U+005C","/":"U+002F","?":"U+003F",".":"U+002E",",":"U+002C","<":"U+003C",">":"U+003E","[":"U+005B","]":"U+005D","{":"U+007B","}":"U+007D","§":"U+00A7","±":"U+00B1","'":"U+0027",'"':"U+0022",":":"U+003A",";":"U+003B","`":"U+0060","~":"U+007E"}};function tl(t){return Ks(t)?Qs.LETTERS[t.toLowerCase()]:Qs.SYMBOLS[t]||Qs.SPECIAL_KEYS[t]||t}function el(t,e,n){var i={};return"keyIdentifier"in KeyboardEvent.prototype&&(i.keyIdentifier=t?"":n),"key"in KeyboardEvent.prototype&&(i.key=e),i}var nl=h.utils.browser,il=h.utils.extend,ol=h.eventSandbox.eventSimulator,rl=(sl._isKeyActivatedInputElement=function(t){return g.domUtils.isInputElement(t)&&/button|submit|reset|radio|checkbox/.test(t.type)},sl.prototype._type=function(t,e){var n,i=t!==this.storedActiveElement,o=!i,r=t,s=g.domUtils.isEditableElement(t),l=g.domUtils.isEditableElement(this.storedActiveElement);try{i&&(n=g.domUtils.isElementInIframe(t)===g.domUtils.isElementInIframe(this.storedActiveElement)||l,o=(!nl.isFirefox||l)&&(!nl.isWebKit||n))}catch(t){}o&&(!nl.isIE&&i&&l&&s&&(r=this.storedActiveElement),Ls(r,e))},sl.prototype._addKeyPropertyToEventOptions=function(t){return il(t,el("keypress"===t.type,this.keyProperty,this.keyIdentifierProperty)),t},sl.prototype.down=function(t){this.storedActiveElement=js(this.topSameDomainDocument),this.modifierKeyCode&&(t[this.sanitizedKey]=!0),t.shift&&this.isLetter&&(this.keyProperty=qs(this.keyProperty));var e={keyCode:this.keyCode,type:"keydown"};return this._addKeyPropertyToEventOptions(e),ol.keydown(this.storedActiveElement,il(e,t))},sl.prototype.press=function(t){if(!this.isChar&&!this.specialKeyCode)return!0;var e=js(this.topSameDomainDocument),n=this.isChar?function(t,e){if("space"===t)return" ";if(e){if(Ks(t))return qs(t);if(g.KEY_MAPS.reversedShiftMap[t])return g.KEY_MAPS.reversedShiftMap[t]}return t}(this.sanitizedKey,t.shift):null,i=this.specialKeyCode||n.charCodeAt(0),o=e!==this.storedActiveElement;if(nl.isWebKit&&o&&g.domUtils.isElementInIframe(e)!==g.domUtils.isElementInIframe(this.storedActiveElement))return!0;this.storedActiveElement=e;var r={keyCode:i,charCode:i,type:"keypress"};this._addKeyPropertyToEventOptions(r);var s=nl.isAndroid||ol.keypress(e,il(r,t));if(!s)return s;e=js(this.topSameDomainDocument),!n||t.ctrl||t.alt||this._type(e,n);var l=sl._isKeyActivatedInputElement(e),a=g.domUtils.isButtonElement(e),u=nl.isSafari&&0<=nl.compareVersions([nl.webkitVersion,"603.1.30"]);return nl.isFirefox||u||!l&&!a||"enter"!==this.sanitizedKey||e.click(),s},sl.prototype.up=function(t){this.modifierKeyCode&&(t[this.sanitizedKey]=!1);var e={keyCode:this.keyCode,type:"keyup"};this._addKeyPropertyToEventOptions(e);var n=ol.keyup(js(this.topSameDomainDocument),il(e,t)),i=js(this.topSameDomainDocument);return!nl.isFirefox&&!nl.isSafari&&(!nl.isChrome||53<=nl.version)&&n&&"space"===this.sanitizedKey&&sl._isKeyActivatedInputElement(i)&&i.click(),n},Object.defineProperty(sl.prototype,"key",{get:function(){return this.sanitizedKey},enumerable:!1,configurable:!0}),sl);function sl(t,e){this.isLetter=Ks(t),this.isChar=1===t.length||"space"===t,this.sanitizedKey=g.getSanitizedKey(t),this.modifierKeyCode=g.KEY_MAPS.modifiers[this.sanitizedKey],this.specialKeyCode=g.KEY_MAPS.specialKeys[this.sanitizedKey],this.keyCode=null,this.keyIdentifierProperty=tl(e),this.topSameDomainDocument=g.domUtils.getTopSameDomainWindow(nu).document,this.keyProperty=g.KEY_MAPS.keyProperty[e]||e,this.isChar&&"space"!==t?this.keyCode=Js(this.sanitizedKey):this.modifierKeyCode?this.keyCode=this.modifierKeyCode:this.specialKeyCode&&(this.keyCode=this.specialKeyCode),this.storedActiveElement=null}var ll,al={ctrlA:"ctrl+a",backspace:"backspace",delete:"delete",left:"left",right:"right",up:"up",down:"down",shiftLeft:"shift+left",shiftRight:"shift+right",shiftUp:"shift+up",shiftDown:"shift+down",shiftHome:"shift+home",shiftEnd:"shift+end",home:"home",end:"end",enter:"enter",tab:"tab",shiftTab:"shift+tab",esc:"esc"},ul=h.Promise,cl=h.utils.browser,hl=h.eventSandbox.eventSimulator,fl=h.eventSandbox.elementEditingWatcher,dl=y.textSelection,ml=y.eventUtils,pl=y.domUtils,vl=o.selectElement,gl=null,El=null;function yl(){El=gl=null,ml.unbind(this,"blur",yl,!0)}function Sl(t){var e,n,i,o;pl.isTextAreaElement(t)&&(gl!==t&&(ml.bind(t,"blur",yl,!0),gl=t),e=t,n=dl.hasInverseSelection(e),i=pl.getTextAreaValue(e),o=n?dl.getSelectionStart(e):dl.getSelectionEnd(e),El=i&&o?pl.getTextareaIndentInLine(e,o):0)}function bl(t,e){var n,i,o,r,s,l,a=pl.getTextAreaValue(t);a&&(n=dl.getSelectionStart(t),i=dl.getSelectionEnd(t),o=dl.hasInverseSelection(t),s=(r=a.substring(0,o?n:i)).lastIndexOf("\n"),l=r.substring(0,s),null!==El&&gl===t||Sl(t),s=l.lastIndexOf("\n"),xl(t,n,i,o,Math.min(s+1+El,l.length),e))}function Pl(t,e){var n,i,o,r,s,l,a,u,c,h,f=pl.getTextAreaValue(t);f&&(n=dl.getSelectionStart(t),i=dl.getSelectionEnd(t),u=(r=(o=dl.hasInverseSelection(t))?n:i)+(l=-1===(c=(s=f.substring(r)).indexOf("\n"))?s.length:c+1),h=-1===(c=(a=s.substring(l)).indexOf("\n"))?a.length:c,null!==El&&gl===t||Sl(t),xl(t,n,i,o,u=Math.min(u+El,u+h),e))}function xl(t,e,n,i,o,r){var s=null,l=null,l=r?(s=e!==n&&i?n:e,o):s=o;dl.select(t,s,l)}function _l(t,e,n){pl.isInputElement(t)&&"number"===t.type&&("-"===e.charAt(0)&&"."===e.charAt(1)&&(e=e.substring(1)),"."===e.charAt(e.length-1)&&(e=e.substring(0,e.length-1))),pl.setElementValue(t,e),dl.select(t,n,n),hl.input(t)}function Cl(t,e){var n,i,o,r,s,l,a,u;return pl.isTextEditableElement(t)&&(n=dl.getSelectionStart(t),i=dl.getSelectionEnd(t),o=dl.hasInverseSelection(t),s=null,s=(r=!pl.isTextAreaElement(t)||pl.getTextareaLineNumberByPosition(t,n)===pl.getTextareaLineNumberByPosition(t,i))?o?i:n:o?n:i,a=-1===(l=pl.getElementValue(t).substring(0,s).lastIndexOf("\n"))?0:l+1,u=null,r?(u=e?s:a,dl.select(t,u,a)):o?dl.select(t,i,a):dl.select(t,n,a)),ul.resolve()}function Al(t,e){var n,i,o,r,s,l,a,u,c;return pl.isTextEditableElement(t)&&(n=dl.getSelectionStart(t),i=dl.getSelectionEnd(t),o=dl.hasInverseSelection(t),s=null,u=s=(r=!pl.isTextAreaElement(t)||pl.getTextareaLineNumberByPosition(t,n)===pl.getTextareaLineNumberByPosition(t,i))?o?i:n:o?n:i,c=null,u+=-1===(a=(l=pl.getElementValue(t).substring(s)).indexOf("\n"))?l.length:a,r?(c=e?s:u,dl.select(t,c,u)):o?dl.select(t,i,u):dl.select(t,n,u)),ul.resolve()}function wl(t){return Cl(t,!0)}function Tl(t){return Al(t,!0)}function Ml(t){return pl.isRadioButtonElement(t)&&!cl.isFirefox}function Ul(t,e){return Dl(t,e,!1).then(function(t){t&&(t.checked=!0)})}function Dl(t,e,n){return void 0===n&&(n=!0),t?(pl.isSelectElement(t)&&vl.collapseOptionList(),i=t,o=e,r=n,new Ws(function(t){var e=Zs(i,o,r);e?Rs.focus(e,function(){return t(e)}):t()}).then(function(t){return t&&pl.isTextEditableInput(t)&&dl.select(t),t})):ul.resolve();var i,o,r}var Il=((ll={})[al.ctrlA]=function(t){return pl.isEditableElement(t)&&dl.select(t),ul.resolve()},ll[al.backspace]=function(t){var e,n,i;return pl.isTextEditableElementAndEditingAllowed(t)&&(e=dl.getSelectionStart(t),n=dl.getSelectionEnd(t),i=pl.getElementValue(t).replace(/\r\n/g,"\n"),n===e?0<e&&_l(t,i.substring(0,e-1)+i.substring(n,i.length),e-1):_l(t,i.substring(0,e)+i.substring(n,i.length),e)),pl.isContentEditableElement(t)&&dl.deleteSelectionContents(t),ul.resolve()},ll[al.delete]=function(t){var e,n,i;return pl.isTextEditableElementAndEditingAllowed(t)&&(e=dl.getSelectionStart(t),n=dl.getSelectionEnd(t),i=pl.getElementValue(t).replace(/\r\n/g,"\n"),n===e?e<i.length&&_l(t,i.substring(0,e)+i.substring(n+1,i.length),e):_l(t,i.substring(0,e)+i.substring(n,i.length),e)),pl.isContentEditableElement(t)&&dl.deleteSelectionContents(t),ul.resolve()},ll[al.left]=function(t){var e,n,i,o,r=null;return pl.isSelectElement(t)&&vl.switchOptionsByKeys(t,"left"),Ml(t)?Ul(t,!0):(pl.isTextEditableElement(t)&&(e=(r=dl.getSelectionStart(t)||0)===dl.getSelectionEnd(t)?r-1:r,dl.select(t,e,e),Sl(t)),pl.isContentEditableElement(t)&&(r=dl.getSelectionStart(t))!==dl.getSelectionEnd(t)&&(n=dl.getSelectionByElement(t),o={node:(i=dl.hasInverseSelectionContentEditable(t))?n.focusNode:n.anchorNode,offset:i?n.focusOffset:n.anchorOffset},dl.selectByNodesAndOffsets(o,o,!0)),ul.resolve())},ll[al.right]=function(t){var e,n,i,o,r=null,s=null;return pl.isSelectElement(t)&&vl.switchOptionsByKeys(t,"right"),Ml(t)?Ul(t,!1):(pl.isTextEditableElement(t)&&(e=(r=dl.getSelectionStart(t))===(s=dl.getSelectionEnd(t))?s+1:s,r===pl.getElementValue(t).length&&(e=r),dl.select(t,e,e),Sl(t)),pl.isContentEditableElement(t)&&(r=dl.getSelectionStart(t))!==(s=dl.getSelectionEnd(t))&&(n=dl.getSelectionByElement(t),o={node:(i=dl.hasInverseSelectionContentEditable(t))?n.anchorNode:n.focusNode,offset:i?n.anchorOffset:n.focusOffset},dl.selectByNodesAndOffsets(o,o,!0)),ul.resolve())},ll[al.up]=function(t){return pl.isSelectElement(t)&&vl.switchOptionsByKeys(t,"up"),Ml(t)?Ul(t,!0):cl.isWebKit&&pl.isInputElement(t)?Cl(t):(pl.isTextAreaElement(t)&&bl(t,!1),ul.resolve())},ll[al.down]=function(t){return pl.isSelectElement(t)&&vl.switchOptionsByKeys(t,"down"),Ml(t)?Ul(t,!1):cl.isWebKit&&pl.isInputElement(t)?Al(t):(pl.isTextAreaElement(t)&&Pl(t,!1),ul.resolve())},ll[al.shiftLeft]=function(t){var e,n;return pl.isTextEditableElement(t)&&((e=dl.getSelectionStart(t))===(n=dl.getSelectionEnd(t))||dl.hasInverseSelection(t)?dl.select(t,n,Math.max(e-1,0)):dl.select(t,e,Math.max(n-1,0)),Sl(t)),ul.resolve()},ll[al.shiftRight]=function(t){var e,n,i;return pl.isTextEditableElement(t)&&(e=dl.getSelectionStart(t),n=dl.getSelectionEnd(t),i=pl.getElementValue(t).length,e!==n&&dl.hasInverseSelection(t)?dl.select(t,n,Math.min(e+1,i)):dl.select(t,e,Math.min(n+1,i)),Sl(t)),ul.resolve()},ll[al.shiftUp]=function(t){return cl.isWebKit&&pl.isInputElement(t)?wl(t):(pl.isTextAreaElement(t)&&bl(t,!0),ul.resolve())},ll[al.shiftDown]=function(t){return cl.isWebKit&&pl.isInputElement(t)?Tl(t):(pl.isTextAreaElement(t)&&Pl(t,!0),ul.resolve())},ll[al.shiftHome]=wl,ll[al.shiftEnd]=Tl,ll[al.home]=Cl,ll[al.end]=Al,ll[al.enter]=function(t){var e,n,i,o,r,s;return pl.isSelectElement(t)&&vl.collapseOptionList(),pl.isInputElement(t)?(cl.isIE||fl.processElementChanging(t),(e=pl.getParents(t,"form")[0])&&function(t,e){var n=t.querySelectorAll("input, button"),i=null,o=null;for(o=0;o<n.length;o++)if(!i&&"submit"===n[o].type&&!n[o].disabled){i=n[o];break}if(i)hl.click(i);else if(pl.blocksImplicitSubmission(e)){for(var r=t.getElementsByTagName("input"),s=[],o=0;o<r.length;o++)pl.blocksImplicitSubmission(r[o])&&s.push(r[o]);1===s.length&&s[0]===e&&e.validity.valid&&hl.submit(t)&&t.submit()}}(e,t)):pl.isTextAreaElement(t)?(n=dl.getSelectionStart(t),o=(i=pl.getTextAreaValue(t)).substring(0,n),r=i.substring(n),s=n+1,_l(t,o+String.fromCharCode(10)+r,s)):t.tagName&&pl.isAnchorElement(t)&&hl.click(t),ul.resolve()},ll[al.tab]=function(t){return Dl(t,!1)},ll[al.shiftTab]=function(t){return Dl(t,!0)},ll[al.esc]=function(t){return pl.isSelectElement(t)&&vl.collapseOptionList(),ul.resolve()},ll),kl=h.Promise,Bl=h.utils.browser,Nl=h.eventSandbox.message,Ol=h.nativeMethods,Fl="automation|press|request",Yl="automation|press|response";Nl.on(Nl.SERVICE_MSG_RECEIVED_EVENT,function(t){t.message.cmd===Fl&&(h.on(h.EVENTS.beforeUnload,function(){return Nl.sendServiceMsg({cmd:Yl},t.source)}),new Ll(t.message.keyCombinations,t.message.options).run().then(function(){return Nl.sendServiceMsg({cmd:Yl},t.source)}))});var Ll=(Kl._getKeyPressSimulators=function(t){var e=function(t){for(var e=t.slice(),n=0;n<t.length;n++){var i=t[n];if("shift"===i.toLowerCase()){var o=t[n+1];if(!o)continue;g.KEY_MAPS.shiftMap[o]?t[n+1]=g.KEY_MAPS.shiftMap[o]:g.KEY_MAPS.reversedShiftMap[o]&&(e[n+1]=g.KEY_MAPS.reversedShiftMap[o])}!g.KEY_MAPS.shiftMap[i]||t[n-1]&&"shift"===t[n-1].toLowerCase()||(t[n]=g.KEY_MAPS.shiftMap[i],t.splice(n,0,"shift"),e.splice(n,0,"shift"),n++)}return{actualKeys:t,eventKeyProperties:e}}(g.getKeyArray(t)),n=e.actualKeys,i=e.eventKeyProperties;return g.arrayUtils.map(n,function(t,e){return new rl(t,i[e])})},Kl._getShortcuts=function(t){for(var e=g.getKeyArray(t.toLowerCase()),n=[],i=[],o=[],r=0;r<e.length;r++)for(i.push(e[r]),o=i.slice();o.length;){var s=o.join("+");Il[s]?(n.push(s),i=o=[]):o.shift()}return n},Kl._getShortcutHandlers=function(t){for(var e,n,i,o=Kl._getShortcuts(t.toLowerCase()),r={},s="",l=0;l<o.length;l++)e=o[l],n=t.indexOf(e),i=e.length,r[s+=t.substring(0,n+i)]=Il[e],t=t.substring(n+i);return r},Kl.prototype._down=function(t){this.pressedKeyString+=(this.pressedKeyString?"+":"")+t.key;var e=!t.down(this.modifiersState);return kl.resolve(e)},Kl.prototype._press=function(t,e){var n=this;if(e&&!this.isSelectElement)return g.delay(this.automationSettings.keyActionStepDelay);var i=this.shortcutHandlers[this.pressedKeyString],o=!1;return i&&!Bl.isFirefox&&"enter"!==t.key||(o=!t.press(this.modifiersState)),o&&!this.isSelectElement||!i?g.delay(this.automationSettings.keyActionStepDelay):i(js(this.topSameDomainDocument)).then(function(){return g.delay(n.automationSettings.keyActionStepDelay)})},Kl.prototype._up=function(t){return t.up(this.modifiersState),g.delay(this.automationSettings.keyActionStepDelay)},Kl.prototype._runCombination=function(t){var n=this;this.modifiersState={ctrl:!1,alt:!1,shift:!1,meta:!1},this.isSelectElement=g.domUtils.isSelectElement(js(this.topSameDomainDocument)),this.pressedKeyString="",this.shortcutHandlers=Kl._getShortcutHandlers(t);var e=Kl._getKeyPressSimulators(t);return g.promiseUtils.each(e,function(e){return n._down(e).then(function(t){return n._press(e,t)})}).then(function(){return g.arrayUtils.reverse(e),g.promiseUtils.each(e,function(t){return n._up(t)})})},Kl.prototype.run=function(){var e=this,t=g.domUtils.getActiveElement(),n=g.domUtils.isIframeElement(t);if(!b(nu)&&n&&Ol.contentWindowGetter.call(t)){var i={cmd:Fl,keyCombinations:this.keyCombinations,options:this.options};return g.sendRequestToFrame(i,Yl,Ol.contentWindowGetter.call(t))}return g.promiseUtils.each(this.keyCombinations,function(t){return e._runCombination(t).then(function(){return g.delay(e.automationSettings.keyActionStepDelay)})})},Kl);function Kl(t,e){this.keyCombinations=t,this.isSelectElement=!1,this.pressedKeyString="",this.modifiersState=null,this.shortcutHandlers=null,this.topSameDomainDocument=g.domUtils.getTopSameDomainWindow(nu).document,this.automationSettings=new J(e.speed),this.options=e}var Xl,Vl=h.Promise,Rl=h.utils.extend,Wl=h.utils.browser,Hl=h.eventSandbox.eventSimulator,Gl=y.domUtils,zl=y.eventUtils,ql=y.delay,jl=(M($l,Xl=Io),$l.prototype._mousedown=function(t){var e=this;return K.rightButtonDown().then(function(){e.eventState.activeElementBeforeMouseDown=Gl.getActiveElement(),e.eventState.simulateDefaultBehavior=Hl.mousedown(t.element,t.options)}).then(function(){return e._focus(t)})},$l.prototype._focus=function(t){return!1===this.simulateDefaultBehavior?Fi():er(Gl.isContentEditableElement(this.element)?this.element:t.element,!Wl.isIE||this.eventState.activeElementBeforeMouseDown===Gl.getActiveElement(),this.caretPos).then(Fi)},$l.prototype._mouseup=function(e){var t=this;return K.buttonUp().then(function(){return t._getElementForEvent(e)}).then(function(t){return Hl.mouseup(t,e.options)})},$l.prototype._contextmenu=function(e){return this._getElementForEvent(e).then(function(t){Hl.contextmenu(t,e.options),Gl.isElementFocusable(t)||ir(t)})},$l.prototype.run=function(t){var o=this,r=null;return this._ensureElement(t).then(function(t){var e=t.element,n=t.clientPoint,i=t.devicePoint;return r={point:n,element:e,options:Rl({clientX:n.x,clientY:n.y,screenX:i.x,screenY:i.y,button:zl.BUTTON.right},o.modifiers)},Vl.all([ql(o.automationSettings.mouseActionStepDelay),o._mousedown(r)])}).then(function(){return o._mouseup(r)}).then(function(){return o._contextmenu(r)})},$l);function $l(t,e){var n=Xl.call(this,t,e)||this;return n.modifiers=e.modifiers,n.caretPos=e.caretPos,n.eventState={simulateDefaultBehavior:!0,activeElementBeforeMouseDown:null},n}var Zl=h.utils.browser,Jl=y.domUtils,Ql=y.positionUtils,ta=y.styleUtils,ea=y.contentEditable,na=y.arrayUtils,ia=["direction","font-family","font-size","font-size-adjust","font-variant","font-weight","font-style","letter-spacing","line-height","text-align","text-indent","text-transform","word-wrap","word-spacing","padding-top","padding-left","padding-right","padding-bottom","margin-top","margin-left","margin-right","margin-bottom","border-top-width","border-left-width","border-right-width","border-bottom-width"];function oa(t,e){var n,i,o,r,s,l=ta.getBordersWidth(t),a=Ql.getOffsetPosition(t),u=t.scrollHeight||t.getBoundingClientRect().height,c=Math.ceil(e.left),h=Math.ceil(e.top),f=Math.floor(e.bottom);return Jl.isTextAreaElement(t)||(i=(n=Ql.offsetToClientCoords({x:a.left,y:a.top})).x+l.left+1,o=n.y+l.top+1,r=n.y+l.top+l.bottom+u,s=n.y+l.top+u-1,c=Math.ceil(c<=n.x?i:e.left),h=Math.ceil(h<=n.y?o:e.top),f=Math.floor(r<=f?s:e.bottom)),{left:c,top:h,bottom:f}}function ra(t){var e=ta.getElementScroll(iu);return{left:t.left+e.left,top:t.top+e.top,bottom:t.bottom+e.top}}function sa(t,e){var n=t.getBoundingClientRect(),i=function(e){var t,n,i,o=iu.body,r=Ql.getOffsetPosition(e),s=ta.getElementMargin(e),l=r.top-s.top,a=r.left-s.left,u=iu.createElement("div"),c="white-space:pre-wrap;border-style:solid;";return"absolute"===ta.get(o,"position")&&(t=ta.getElementMargin(o),n=ta.get(o,"left"),i=ta.get(o,"top"),a-=t.left+(parseInt(n.replace("px",""),10)||0),l-=t.top+(parseInt(i.replace("px",""),10)||0)),na.forEach(ia,function(t){c+=t+":"+ta.get(e,t)+";"}),ta.set(u,{cssText:c,position:"absolute",left:a+"px",top:l+"px",width:e.scrollWidth+"px",height:e.scrollHeight+"px"}),h.nativeMethods.nodeTextContentSetter.call(u,Jl.getElementValue(e)+" "),o.appendChild(u),u}(t),o=null,r=t.getBoundingClientRect(),s=r.top-n.top,l=r.left-n.left,a=Jl.getElementValue(t).length;try{var u=iu.createRange();u.setStart(h.nativeMethods.nodeFirstChildGetter.call(i),Math.min(e,a)),u.setEnd(h.nativeMethods.nodeFirstChildGetter.call(i),Math.min(e+1,a+1)),Jl.isTextAreaElement(t)&&(0!==(o=u.getBoundingClientRect()).width||0!==o.height)||(o=u.getClientRects()[0])}catch(t){o=null}return Jl.remove(i),o?{width:o.width,height:o.height,top:o.top-s,bottom:o.bottom-s,left:o.left-l,right:o.right-l}:null}function la(t,e){var n,i,o,r,s,l,a=null;return(a=Jl.isContentEditableElement(t)?(o=t,r=e,s=Jl.findDocument(o).createRange(),l=ea.calculateNodeAndOffsetByPosition(o,r),s.setStart(l.node,Math.min(l.offset,l.node.length)),s.setEnd(l.node,Math.min(l.offset,l.node.length)),s.getClientRects()[0]):"function"==typeof t.createTextRange?(n=e,(i=t.createTextRange()).collapse(!0),i.moveStart("character",n),i.moveEnd("character",n),i.collapse(!0),i.getBoundingClientRect()):sa(t,e))?{x:(a=ra(a=oa(t,a))).left,y:Math.floor(a.top+(a.bottom-a.top)/2)}:null}function aa(t,e){var n=Jl.isTextEditableElement(t),i=Jl.isContentEditableElement(t);return n&&0<Jl.getElementValue(t).length||i&&ea.getContentEditableValue(t).length?la(t,e):Ql.findCenter(t)}function ua(t,e,n){var i=Jl.findDocument(t).createRange();i.setStart(e,Math.min(n,e.length)),i.setEnd(e,Math.min(n,e.length));var o=i.getClientRects()[0];return o?{x:(o=ra(oa(t,o))).left,y:Math.floor(o.top+(o.bottom-o.top)/2)}:null}var ca,ha=h.Promise,fa=h.utils.browser,da=h.utils.featureDetection,ma=h.eventSandbox.eventSimulator,pa=h.eventSandbox.focusBlur,va=y.contentEditable,ga=y.domUtils,Ea=y.positionUtils,ya=y.eventUtils,Sa=y.delay,ba=(M(Pa,ca=Io),Pa._calculateEventArguments=function(t){var n=Ea.offsetToClientCoords(t);return j(n.x,n.y).then(function(t){var e=t.element;if(!e)throw new Error(Z.elementIsInvisibleError);return{element:e,options:{clientX:n.x,clientY:n.y}}})},Pa.prototype._move=function(t){var e=this,n=t.element,i=t.offsetX,o=t.offsetY,r=t.speed,s=new Si({offsetX:i,offsetY:o,speed:r},!1);return new wo(n,s).run().then(function(){return Sa(e.automationSettings.mouseActionStepDelay)})},Pa.prototype._bindMousedownHandler=function(){var e=this,n=function(t){e.eventState.mousedownPrevented=t.defaultPrevented,ya.preventDefault(t),ya.unbind(e.element,"mousedown",n)};ya.bind(this.element,"mousedown",n)},Pa.prototype._calculateAbsoluteStartPoint=function(){throw new Error("Not implemented")},Pa.prototype._calculateAbsoluteEndPoint=function(){throw new Error("Not implemented")},Pa.prototype._moveToPoint=function(t){!function(t,e){if(Jl.isEditableElement(t)){var n=Jl.isTextAreaElement(t);if(!Jl.isInputElement(t)||!(Zl.isFirefox||Zl.isIE&&10<Zl.version)){var i=Ql.getOffsetPosition(t),o=ta.getBordersWidth(t),r=ta.getElementScroll(t),s=e.x-i.left-o.left,l=e.y-i.top-o.top,a=null;if(n)return l<r.top&&(a=l),l>t.clientHeight+r.top&&(a=l-t.clientHeight),null!==a&&ta.setScrollTop(t,Math.round(a));s<r.left&&(a=s),s>t.clientWidth+r.left&&(a=s-t.clientWidth),null!==a&&ta.setScrollLeft(t,Math.round(a))}}}(this.element,t),this.clientPoint=function(t,e){var n=Jl.isTextEditableElement(t),i=Jl.isInputElement(t);if(!n&&!Jl.isContentEditableElement(t))return e;var o=Ql.getOffsetPosition(t),r=ta.getBordersWidth(t),s=ta.getElementScroll(t),l=o.left+r.left+t.clientWidth;return i&&n&&(Zl.isFirefox||Zl.isIE&&10<Zl.version)?{x:Math.min(e.x,l),y:e.y}:{x:e.x-s.left,y:e.y-s.top}}(this.element,t);var e={element:iu.documentElement,offsetX:this.clientPoint.x,offsetY:this.clientPoint.y,speed:this.speed};return this._move(e)},Pa.prototype._mousedown=function(){var n=this;return K.leftButtonDown().then(function(){return Pa._calculateEventArguments(n.clientPoint)}).then(function(t){n.eventArgs=t;var e=(fa.isWebKit||fa.isIE)&&ga.isSelectElement(n.element);return e&&n._bindMousedownHandler(),n.eventState.simulateDefaultBehavior=ma[n.downEvent](n.eventArgs.element,n.eventArgs.options),!1===n.eventState.simulateDefaultBehavior&&(n.eventState.simulateDefaultBehavior=e&&!n.eventState.mousedownPrevented),n._focus()})},Pa.prototype._focus=function(){var n=this;return new ha(function(t){var e=ga.isContentEditableElement(n.element)?va.findContentEditableParent(n.element):n.element;pa.focus(e,t,!1,!0)})},Pa.prototype._setSelection=function(){throw new Error("Not implemented")},Pa.prototype._mouseup=function(){var e=this;return K.buttonUp().then(function(){return e._setSelection(),Pa._calculateEventArguments(e.clientPoint)}).then(function(t){e.eventArgs=t,ma[e.upEvent](e.eventArgs.element,e.eventArgs.options)})},Pa.prototype.run=function(){var t=this;return this.absoluteStartPoint=this._calculateAbsoluteStartPoint(),this.absoluteEndPoint=this._calculateAbsoluteEndPoint(),this._moveToPoint(this.absoluteStartPoint).then(function(){return t._mousedown()}).then(function(){return t._moveToPoint(t.absoluteEndPoint)}).then(function(){return t._mouseup()})},Pa);function Pa(t,e){var n=ca.call(this,t,e)||this;return n.absoluteStartPoint=null,n.absoluteEndPoint=null,n.clientPoint=null,n.speed=e.speed,n.downEvent=da.isTouchDevice?"touchstart":"mousedown",n.upEvent=da.isTouchDevice?"touchend":"mouseup",n.eventArgs={options:null,element:null},n.eventState={mousedownPrevented:!1,simulateDefaultBehavior:!0},n}var xa,_a=y.textSelection,Ca=y.domUtils,Aa=y.positionUtils,wa=(M(Ta,xa=ba),Ta.prototype._calculateAbsoluteStartPoint=function(){return aa(this.element,this.startPos)||Aa.findCenter(this.element)},Ta.prototype._calculateAbsoluteEndPoint=function(){var t=aa(this.element,this.endPos);return t||(Ca.isContentEditableElement(this.element)?function(t,e,n){for(var i=n<e?1:-1,o=n,r=null;o!==e&&!(r=la(t,o+=i)););return r=r||la(t,e)||Ql.findCenter(t)}(this.element,this.startPos,this.endPos):Aa.findCenter(this.element))},Ta.prototype._setSelection=function(){var t=Ca.isTextEditableElement(this.element),e=Ca.isContentEditableElement(this.element);(t||e)&&!1!==this.eventState.simulateDefaultBehavior&&_a.select(this.element,this.startPos,this.endPos)},Ta.prototype.run=function(t){var e=this;return this._ensureElement(t).then(function(){return xa.prototype.run.call(e)})},Ta);function Ta(t,e,n,i){var o=xa.call(this,t,i)||this;return o.startPos=e,o.endPos=n,o}var Ma,Ua=y.textSelection,Da=y.contentEditable,Ia=y.positionUtils,ka=(M(Ba,Ma=ba),Ba.prototype._calculateAbsoluteStartPoint=function(){return ua(this.element,this.startNode,this.startOffset)||Ia.findCenter(this.element)},Ba.prototype._calculateAbsoluteEndPoint=function(){return ua(this.element,this.endNode,this.endOffset)||Ia.findCenter(this.element)},Ba.prototype._setSelection=function(){var t,e;!1!==this.eventState.simulateDefaultBehavior&&(t={node:this.startNode,offset:this.startOffset},e={node:this.endNode,offset:this.endOffset},Ua.selectByNodesAndOffsets(t,e,!0))},Ba);function Ba(t,e,n){var i=Ma.call(this,Da.getNearestCommonAncestor(t,e),n)||this,o=Da.getFirstVisiblePosition(t),r=Da.getLastVisiblePosition(e),s={node:t,offset:o},l={node:e,offset:r},a=Da.calculatePositionByNodeAndOffset(i.element,s);return Da.calculatePositionByNodeAndOffset(i.element,l)<a&&(o=Da.getLastVisiblePosition(t),r=Da.getFirstVisiblePosition(e)),s=Da.calculateNodeAndOffsetByPosition(t,o),l=Da.calculateNodeAndOffsetByPosition(e,r),i.startNode=s.node,i.startOffset=s.offset,i.endNode=l.node,i.endOffset=l.offset,i}var Na=h.Promise,Oa=h.utils.extend,Fa=h.utils.browser,Ya=h.eventSandbox.eventSimulator,La=h.eventSandbox.elementEditingWatcher,Ka=y.domUtils,Xa=y.promiseUtils,Va=y.contentEditable,Ra=y.textSelection,Wa=y.delay,Ha=y.KEY_MAPS.specialKeys,Ga=(za.findTextEditableChild=function(t){var e=null;if(!Ka.isEditableElement(t))for(var n=t.querySelectorAll("*"),i=0;i<n.length;i++)if(Ka.isTextEditableElementAndEditingAllowed(n[i])){e=n[i];break}return e},za.prototype._calculateEventArguments=function(t){var e=Ka.getActiveElement(),n=Ka.isContentEditableElement(this.element),i=this.eventArgs.element||this.element;n||e===i||(i=za.findTextEditableChild(e)||e);var o=Oa({keyCode:t?this.currentCharCode:this.currentKeyCode},this.modifiers);return t&&(o.charCode=this.currentCharCode),Oa(o,el(t,this.currentKey,this.currentKeyIdentifier)),{element:i,options:o}},za.prototype._calculateTargetElement=function(){var t=Ka.getActiveElement(),e=Ka.isContentEditableElement(this.element);if(e){if(t!==Va.findContentEditableParent(this.element))return void(this.eventState.skipType=!0)}else if(t!==this.element)return void(this.eventState.skipType=!0);this.element=e?this.element:t},za.prototype._click=function(t){var e,n=this,i=Ka.getActiveElement(),o=Ka.isTextEditableElementAndEditingAllowed(this.element),r=Ka.isContentEditableElement(this.element);if(i===this.element)return o&&La.watchElementEditing(this.element),(o||r)&&(e=Ra.getSelectionStart(this.element),isNaN(parseInt(this.caretPos,10))||this.caretPos===e||Ra.select(this.element,this.caretPos,this.caretPos)),Na.resolve();var s=O(this.element),l=s.offsetX,a=s.offsetY,u=new gi({offsetX:this.elementChanged?l:this.offsetX,offsetY:this.elementChanged?a:this.offsetY,speed:this.speed,caretPos:this.caretPos,modifiers:this.modifiers});return new Or(this.element,u).run(t).then(function(){return Wa(n.automationSettings.mouseActionStepDelay)})},za.prototype._type=function(){var t=this;if(this.eventState.skipType)return Na.resolve();var e=Ka.isContentEditableElement(this.element);return this.replace&&(Ka.isTextEditableElementAndEditingAllowed(this.element)?Ra.select(this.element):e&&Ra.deleteSelectionContents(this.element,!0)),Xa.whilst(function(){return!t._isTypingFinished()},function(){return t._typingStep()})},za.prototype._isTypingFinished=function(){return this.currentPos===this.typingText.length},za.prototype._typingStep=function(){var t=this.typingText.charAt(this.currentPos);return this.currentKeyCode=Js(t),this.currentCharCode=this.typingText.charCodeAt(this.currentPos),this.currentKey=this.currentKeyCode===Ha.enter?"Enter":t,this.currentKeyIdentifier=tl(this.currentKey),this.ignoreChangeEvent=Ka.getElementValue(this.element)===La.getElementSavedValue(this.element),this._keydown(),this._keypress(),this._keyup()},za.prototype._keydown=function(){this.eventArgs=this._calculateEventArguments(),this.eventState.simulateKeypress=Ya.keydown(this.eventArgs.element,this.eventArgs.options)},za.prototype._keypress=function(){!1!==this.eventState.simulateKeypress&&(this.eventArgs=this._calculateEventArguments(!0),this.eventState.simulateTypeChar=Fa.isAndroid||Ya.keypress(this.eventArgs.element,this.eventArgs.options))},za.prototype._keyup=function(){var t=this,e=this.eventArgs.element;this.eventArgs=this._calculateEventArguments();var n=Ka.isTextEditableElement(this.element),i=Ka.isContentEditableElement(this.element),o=this.paste||!n&&!i;return Na.resolve().then(function(){return o?t._typeAllText(e):t._typeChar(e)}).then(function(){Ya.keyup(t.eventArgs.element,t.eventArgs.options),o?t.currentPos=t.typingText.length:t.currentPos++})},za.prototype._typeChar=function(t){if(!1===this.eventState.simulateKeypress||!1===this.eventState.simulateTypeChar)return this.ignoreChangeEvent&&La.restartWatchingElementEditing(t),Wa(this.automationSettings.keyActionStepDelay);var e=this.typingText.charAt(this.currentPos),n=/^\d$/.test(e),i=0===this.currentPos?null:this.typingText.charAt(this.currentPos-1);if(Ka.isInputElement(t)&&"number"===t.type){var o=Ra.getSelectionStart(t),r=Ka.getInputValue(t).length,s=/^\d/.test(this.typingText);if(!n&&(s||!("."===e||"-"===e&&r)||0!==o))return Wa(this.automationSettings.keyActionStepDelay);n&&("."===i||"-"===i&&!r)&&(e=i+e)}return Ls(t,e,null),Wa(this.automationSettings.keyActionStepDelay)},za.prototype._typeAllText=function(t){return Ls(t,this.typingText,this.caretPos),Wa(this.automationSettings.keyActionStepDelay)},za.prototype.run=function(t){var e=this;return this._click(t).then(function(){return e._calculateTargetElement()}).then(function(){return e._type()})},za);function za(t,e,n){this.element=za.findTextEditableChild(t)||t,this.typingText=e.toString(),this.modifiers=n.modifiers,this.caretPos=n.caretPos,this.replace=n.replace,this.paste=n.paste,this.offsetX=n.offsetX,this.offsetY=n.offsetY,this.speed=n.speed,this.automationSettings=new J(this.speed),this.elementChanged=t!==this.element,this.currentPos=0,this.currentKeyCode=null,this.currentCharCode=null,this.currentKey=null,this.currentKeyIdentifier=null,this.ignoreChangeEvent=!0,this.eventArgs={options:null,element:null},this.eventState={skipType:!1,simulateKeypress:!0,simulateTypeChar:!0}}var qa=(ja.prototype.run=function(){var i=this;return t.doUpload(this.element,this.paths).then(function(t){if(t.length){var e=g.arrayUtils.map(t,function(t){return t.path}),n=g.arrayUtils.reduce(t,function(t,e){return t.concat(e.resolvedPaths)},[]);throw i.createError(e,n)}})},ja);function ja(t,e,n){this.element=t,this.paths=e,this.createError=n}var $a=y.domUtils,Za=y.contentEditable,Ja={};Ja.DispatchEvent=E,Ja.Scroll=A,Ja.SetScroll=Oo,Ja.ScrollIntoView=Lo,Ja.Click=Or,Ja.SelectChildClick=jr,Ja.DblClick=os,Ja.DragToOffset=vs,Ja.DragToElement=Ss,Ja.Hover=xs,Ja.Press=Ll,Ja.RClick=jl,Ja.SelectText=wa,Ja.SelectEditableContent=ka,Ja.Type=Ga,Ja.Upload=qa,Ja.MouseOptions=mi,Ja.ClickOptions=gi,Ja.TypeOptions=wi,Ja.ERROR_TYPES=Z,Ja.AutomationSettings=J,Ja.getOffsetOptions=F,Ja.calculateSelectTextArguments=function(t,e){void 0===e&&(e={});var n,i,o,r,s,l,a,u,c,h,f,d=$a.isTextEditableElement(t),m=d?0:Za.getFirstVisiblePosition(t),p=d?$a.getElementValue(t).length:Za.getLastVisiblePosition(t),v=e.startPos?Math.min(e.startPos,p):m,g=void 0===e.endPos||null===e.endPos?p:Math.min(e.endPos,p);return void 0!==e.offset?(g=0<=e.offset?Math.min(e.offset,g):(v=g,Math.max(0,g+e.offset)),{startPos:v,endPos:g}):void 0!==e.startLine?(n=t,i=e,o=$a.getTextAreaValue(n),r=o&&o.length?o.split("\n"):[],s=r.length-1,l=i.startLine?Math.min(i.startLine,s):0,a=r[l]?r[l].length:0,u=i.startPos?Math.min(i.startPos,a):0,c=void 0===i.endLine||null===i.endLine?s:Math.min(i.endLine,s),h=r[c]?r[c].length:0,f=void 0===i.endPos||null===i.endPos?h:Math.min(i.endPos,h),{startPos:$a.getTextareaPositionByLineAndOffset(n,l,0)+u,endPos:$a.getTextareaPositionByLineAndOffset(n,c,0)+f}):{startPos:v,endPos:g}},Ja.cursor=K,Ja.getNextFocusableElement=Zs,Ja.SHORTCUT_TYPE=al,Ja.getSelectionCoordinatesByPosition=aa,Ja.getElementFromPoint=j;var Qa=h.nativeMethods,tu=h.EVENTS.evalIframeScript;Qa.objectDefineProperty(nu,"%testCafeAutomation%",{configurable:!0,value:Ja}),h.on(tu,function(t){return eu(Qa.contentWindowGetter.call(t.iframe))})}(nu["%hammerhead%"],nu["%testCafeCore%"],nu["%hammerhead%"].Promise,nu["%testCafeUI%"])}(window);